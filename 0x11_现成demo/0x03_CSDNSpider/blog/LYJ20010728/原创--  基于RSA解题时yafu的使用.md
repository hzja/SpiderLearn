# 原创
：  基于RSA解题时yafu的使用

# 基于RSA解题时yafu的使用

### **yafu安装使用方法以及mismatched parens解决方法**

**1. windows安装**<br/> [下载链接](https://sourceforge.net/projects/yafu/)

**2. linux安装**<br/> 由于yafu的elf文件是静态编译的，在一些系统上想要使用yafu就得重新编译。<br/> 这里参考一下[大佬的链接](https://www.cnblogs.com/pcat/p/7508205.html)

```
apt-get update
apt-get install gcc m4 zlib1g-dev make -y

mkdir -p $HOME/src

# install gmp
cd $HOME/src
v=6.1.2
wget https://gmplib.org/download/gmp/gmp-${v}.tar.bz2
tar -jxvf gmp-${v}.tar.bz2 &amp;&amp; mv gmp-${v} gmp &amp;&amp; cd gmp
./configure
make &amp;&amp; make check &amp;&amp; make install

# install gmp-ecm
cd $HOME/src
v=6.2
wget https://gforge.inria.fr/frs/download.php/file/4663/ecm-${v}.tar.gz
tar zxvf ecm-${v}.tar.gz &amp;&amp; mv ecm-${v} gmp-ecm &amp;&amp; cd gmp-ecm
# replace __GMP_BITS_PER_MP_LIMB with GMP_LIMB_BITS
x='__GMP_BITS_PER_MP_LIMB';y='GMP_LIMB_BITS';sed -i "s#${x}#${y}#g" `grep ${x} -rl .`
./configure --with-gmp=/usr/local
make &amp;&amp; make install

# install msieve
cd $HOME/src
v1=1.53
v2=153
# https://sourceforge.net/projects/msieve/files/latest/download
# wget http://downloads.sourceforge.net/project/msieve/msieve/Msieve%20v${v1}/msieve${v2}.tar.gz
wget https://netix.dl.sourceforge.net/project/msieve/msieve/Msieve%20v${v1}/msieve${v2}_src.tar.gz
tar zxvf msieve${v2}.tar.gz &amp;&amp; mv msieve-${v1} msieve &amp;&amp; cd msieve
make all

# install yafu
cd $HOME/src
git clone https://github.com/DarkenCode/yafu
cd yafu
# modify Makefile
sed -i 's#INC = -I. -Iinclude#&amp; -Itop/aprcl#;s#gmp/include#gmp#g;s#gmp/lib/linux/x86_64#gmp/.libs#;
s#gmp-ecm/include/linux#gmp-ecm#g;s#gmp-ecm/lib/linux/x86_64#gmp-ecm/.libs#;
s#msieve/lib/linux/x86_64#msieve#;122i LIBS+= -lc -lz' Makefile
# comment
sed -i 's#printf("setting prime roots#//&amp;#g;s#printf("medsieve#//&amp;#g;s#printf("lpsieve#//&amp;#g;
s#printf("scan p#//&amp;#g;s#printf("next B#//&amp;#g;s#printf("next roots#//&amp;#g' factor/qs/SIQS.c
make x86_64 NFS=1

```

**3. yafu使用方法**<br/> 这里建议把它写入到环境变量里面<br/> cmd输入yafu-x64进入命令行<br/> 最常用的命令是factor(n)，将n值分解

```
C:\Users\86138&gt;yafu-x64
factor(197)


fac: factoring 197
fac: using pretesting plan: normal
fac: no tune info: using qs/gnfs crossover of 95 digits
div: primes less than 10000
Total factoring time = 0.0123 seconds


***factors found***

P3 = 197

ans = 1

```

**4. 使用yafu的时候遇到mismatched parens**<br/> 由于在命令行里不支持过长的位数，所以我们只要把n的值从文件中去读取即可。<br/> 新建一个文件test.txt，内容里写上n的值，如：

```
966808932627497190635859236054960349099463975227350564265384373280336699853387254070662881265937565163000758606154308757944030571837175048514574473061401566330836334647176655282619268592560172726526643074499534129878217409046045533656897050117438496357231575999185527675071002803951800635220029015932007465117818739948903750200830856115668691007706836952244842719419452946259275251773298338162389930518838272704908887016474007051397194588396039111216708866214614779627566959335170676055025850932631053641576566165694121420546081043285806783239296799795655191121966377590175780618944910532816988143056757054052679968538901460893571204904394975714081055455240523895653305315517745729334114549756695334171142876080477105070409544777981602152762154610738540163796164295222810243309051503090866674634440359226192530724635477051576515179864461174911975667162597286769079380660782647952944808596310476973939156187472076952935728249061137481887589103973591082872988641958270285169650803792395556363304056290077801453980822097583574309682935697260204862756923865556397686696854239564541407185709940107806536773160263764483443859425726953142964148216209968437587044617613518058779287167853349364533716458676066734216877566181514607693882375533

```

注意：最后面一定要换行，不然会出现eof; done processing batchfile<br/> 然后运行命令为：

```
yafu-x64 "factor(@)" -batchfile test.txt

```

```
C:\Users\86138&gt;yafu-x64 "factor(@)" -batchfile D:/Users/86138/Desktop/test.txt


=== Starting work on batchfile expression ===
factor(966808932627497190635859236054960349099463975227350564265384373280336699853387254070662881265937565163000758606154308757944030571837175048514574473061401566330836334647176655282619268592560172726526643074499534129878217409046045533656897050117438496357231575999185527675071002803951800635220029015932007465117818739948903750200830856115668691007706836952244842719419452946259275251773298338162389930518838272704908887016474007051397194588396039111216708866214614779627566959335170676055025850932631053641576566165694121420546081043285806783239296799795655191121966377590175780618944910532816988143056757054052679968538901460893571204904394975714081055455240523895653305315517745729334114549756695334171142876080477105070409544777981602152762154610738540163796164295222810243309051503090866674634440359226192530724635477051576515179864461174911975667162597286769079380660782647952944808596310476973939156187472076952935728249061137481887589103973591082872988641958270285169650803792395556363304056290077801453980822097583574309682935697260204862756923865556397686696854239564541407185709940107806536773160263764483443859425726953142964148216209968437587044617613518058779287167853349364533716458676066734216877566181514607693882375533)
=============================================
fac: factoring 966808932627497190635859236054960349099463975227350564265384373280336699853387254070662881265937565163000758606154308757944030571837175048514574473061401566330836334647176655282619268592560172726526643074499534129878217409046045533656897050117438496357231575999185527675071002803951800635220029015932007465117818739948903750200830856115668691007706836952244842719419452946259275251773298338162389930518838272704908887016474007051397194588396039111216708866214614779627566959335170676055025850932631053641576566165694121420546081043285806783239296799795655191121966377590175780618944910532816988143056757054052679968538901460893571204904394975714081055455240523895653305315517745729334114549756695334171142876080477105070409544777981602152762154610738540163796164295222810243309051503090866674634440359226192530724635477051576515179864461174911975667162597286769079380660782647952944808596310476973939156187472076952935728249061137481887589103973591082872988641958270285169650803792395556363304056290077801453980822097583574309682935697260204862756923865556397686696854239564541407185709940107806536773160263764483443859425726953142964148216209968437587044617613518058779287167853349364533716458676066734216877566181514607693882375533
fac: using pretesting plan: normal
fac: no tune info: using qs/gnfs crossover of 95 digits
div: primes less than 10000
fmt: 1000000 iterations
Total factoring time = 0.3018 seconds


***factors found***

PRP617 = 31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928997877221
PRP617 = 31093551302922880999883020803665536616272147022877428745314830867519351013248914244880101094365815998050115415308439610066700139164376274980650005150267949853671653233491784289493988946869396093730966325659249796545878080119206283512342980854475734097108975670778836003822789405498941374798016753689377992355122774401780930185598458240894362246194248623911382284169677595864501475308194644140602272961699230282993020507668939980205079239221924230430230318076991507619960330144745307022538024878444458717587446601559546292026245318907293584609320115374632235270795633933755350928537598242214216674496409625928797450473

ans = 1

```

注意：运行后，test.txt就会消失了
