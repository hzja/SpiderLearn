# 原创
：  Web漏洞-XSS跨站漏洞之原理分类及攻击手法

# Web漏洞-XSS跨站漏洞之原理分类及攻击手法

## 一、xss跨站漏洞导图

## 二、XSS跨站漏洞概述 

### 1.产生原理，危害以及特点：

前端提交的一些参数转换为js代码，可以回显一些想要的东西；其产生层面是在前端；常见的一些输出性的函数与此漏洞有关；漏洞的危害收到js代码的影响，同时也收到浏览器内核的影响。

首先写一个简单的验证代码。

输入js代码，网页成功执行。

不同的浏览器内核对XSS漏洞的影响。

### 2.分类：

## 三、靶场实操

### 1.反射型（非持续型）

打开对应靶场。

在输入框输入“didi”。

根据上图可知，输入的内容会在网页内进行显示。

由此想到如果将输入的内容更改为js语句，则js语句也会在网页内显示。

而如果它显示了，因为这个页面是在浏览器上运行的，所以浏览器会识别到你输入的js代码，并对其进行执行，从而形成了跨站漏洞。

在输入框内输入如下代码：

```
#' onclick="alert(2)"&gt;

---&gt;鼠标触发事件
```

直接粘贴代码后发现搜索框有长度限制，解决的办法有很多：

可以右键后点击检查，将长度改大。

也可以更改输入代码使其变简短。

```
&lt;script&gt;alert(1)&lt;/script&gt;
```

还可以直接在url内进行输入。

选取一种方法完成输入后可以看到网页成功执行了js命令，浏览器窗口弹出了“1”。

选择图示位置后右键点击检查，可以看到刚刚输入的内容被当作js代码了。

### 2.存储型（持续型）

打开对应靶场。

首先在留言板内输入“1”后提交。

刷新页面，发现刚刚输入的内容还在。

在留言板内输入下面代码并提交。

```
&lt;script&gt;alert(1)&lt;/script&gt;
```

可以看到网页窗口又弹出了“1”。

刷新网页或者从其它网页内切入，发现每次浏览器依然会有弹窗出现。

由此可知，网站是将代码存储到了数据库里面。

如果输入的是攻击代码，那么这个攻击就会一直持续到将此代码删除掉为止。

### 3.DOM型

第一类：点击其它页码后，网址发生明显变化。

此情况是通过操作参数来实现的。 

第二类：点击“查看更多”后，内容增加，但是网址没有发生变化。

此情况是通过操作htlm里的代码来实现的。

打开对应靶场。

在输入框内随便输入一些内容后提交，可以看到如下页面。

点击下面的一行文字后，会新出现一行文字。

```
html代码或者js代码编写的网页在客户端和服务端看到的代码内容是一样的。

php代码编写的网页客户端和服务端看到的源代码是不同的，
客户端的代码是被编译后的代码。
```

### 4.三种类型总结：

发包x=didi===&gt;x.php===&gt;回包

发包x=didi===&gt;x.php===&gt;写到数据库某个表中===&gt;x.php回包

发包x=didi===&gt;本地浏览器静态前端代码===&gt;x.php

## 四、跨站漏洞常见攻击以及攻击层面

举例：单页面的网站（在网站内直接要求输入信息进行提交）。

这种页面一般会有一个后台，用来查看用户输入的个人信息，用户输入什么页面内就显示什么，如果用户输入的是跨站代码，那么就可能被执行，因此可以想到利用xss漏洞。

在留言板内输入带有js语句的内容后点击提交。

页面返回了错误信息，原因是网站存在过滤。

修改留言板内容再次尝试提交，发现提交成功。

此时来到管理员视角，发现有新的留言。

当管理员打开页面进行查看时，js代码便执行成功了，但是留言板上显示的内容是正确的，没有显示出刚刚输入的js代码。

因为此时js代码已经写到网页中了。
