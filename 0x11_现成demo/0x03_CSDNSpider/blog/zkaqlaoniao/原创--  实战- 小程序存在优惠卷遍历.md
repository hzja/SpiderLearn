# 原创
：  实战| 小程序存在优惠卷遍历

# 实战| 小程序存在优惠卷遍历

本文由掌控安全学院 - 守法好青年 投稿

<br/> 进入小程序，因为是一个小商城，所以照例先查看收货地址是否存在越权，以及能否未授权访问，但是发现不存在这些问题，所以去查看优惠卷

进入领券中心，点击领取优惠券时抓包<img alt="" height="205" src="https://img-blog.csdnimg.cn/direct/d8c87e10b56e43fca6bdfbd87389b780.png" width="507"/>

发现数据包，存在敏感参数id

<img alt="" height="422" src="https://img-blog.csdnimg.cn/direct/41591f358b8b4442aa363809029fd19c.png" width="913"/><br/> 本来是测的能不能并发，直接领取多次，但是发现不可以，所以转变思路，遍历id，查看能否领取所有优惠卷

果不其然，除了已经所有人无法领取的优惠卷外，其他所有优惠卷都可以领取，包括但不限于生日专享，社群专享，还有会员专享

<img alt="" height="722" src="https://img-blog.csdnimg.cn/direct/5cce8ec4ff7a4444b7887a0836b395a3.png" width="461"/><br/> 应该算是中危

### 重点

这次是挖歪了，所以对于挖小程序的师傅，我稍微提醒一下，就是你挖的小程序的资产是否是你那个src不是看小程序的名字，包括小字的什么什么有限公司，你真正应该关注的是数据包里的Host参数

<img alt="" height="343" src="https://img-blog.csdnimg.cn/direct/d015b9490fa54d19803236a606d79a8f.png" width="1041"/>千万别挖歪了，所以一定要做好信息搜集，什么小蓝本，企查查。。。之类的

申明：本文所分享内容仅用于网络安全技术讨论，切勿用于违法途径，

所有渗透都需获取授权，违者后果自行承担，与本号及作者无关，请谨记守法.
