# 原创
：  红队基础建设与介绍

# 红队基础建设与介绍

### 1.ATT&amp;CK相关背景

ATT&amp;CK在各种日常环境中都很有价值。开展任何防御活动时，可以应用ATT&amp;CK防御法，参考攻击者及其行为。ATT&amp;CK不仅对网络防御者提供通用技术库，还为渗透测试和红队提供了基础。提到对抗行为时，这为防御者和红队提供了通用语言。

1.对抗模拟

2.红队/渗透测试

3.指定行为分析防范

4.防御差距评估

5.SOC成熟评估

6.威胁情报收集

### 2.渗透测试与红队

渗透测试和红队主要区别是时间范围，渗透测试任务时间可能长达一周至一个月，红队的测试短达两周长达六个月以及更久。

红队一般会针对目标系统、人员、软件、硬件和设备同时执行的多角度、混合、对抗性的模拟攻击；通过实现系统提权、控制业务、获取数据等目标，来发现系统、技术、人员和基础架构中存在的网络安全隐患或薄弱环节。

我们需要模拟真实的攻击，利用社会工程学，远控木马、持久性、等技术。

#### 2.1.渗透测试

**有详细计划等安全评估测试**

1.渗透测试前双方制定计划

2.信息收集

3.漏洞分析

4.漏洞利用

5.后渗透阶段

6.编写测试报告

**范围**

1.有限制规则

2.1-2周的测试流程

3.有问题正常公告

4.发现漏洞

#### 2.2.红队

**充满不定性的安全评估测试**

1.情报收集

2.撕口子

3.持久性/本地提权

4.本地/网络信息盘点

5.内网横向渗透

6.寻找机密资料/窃取

7.域内提权/抓取域内用户哈希

8.编写测试报告

**范围**

1.没有规则

2.1周-6个月的测试流程

3.有问题暂不公告

4.测试蓝队的工作计划，工作策略，工具和技能。

5.不能违法

### 3.红队基础建设

#### 3.1.设定行动

##### 3.1.1.团队协作

内部聊天工具：Rocket.Chat 等（文件传输、信息传递）

分工明确

进度同步

##### 3.1.2.制定计划

分析任务

检测时效（TTD）

​ 入侵事件的初始发生到安全分析人员检测并开始处理入侵事件之间的时间

缓解时效（TTM）

​ 当进行防火墙阻止入侵，网络隔离这些操作的时候，记录的时间

##### 3.1.3.确认目标

确定行动范围

抵达目标路线

#### 3.2.功能隔离

##### 3.2.1.网络钓鱼MSTP

SMTP

站点克隆

##### 3.2.2.Shellcode有效载荷

制定加载流量，流量特征隐藏

##### 3.2.3.长期C2

明确好重点目标，规避流量过于重复频繁

##### 3.2.4.短期C2

非重要目标，防止被防火墙特征标记

#### 3.3.设置外部服务器

为什么要设置外部服务器？

1.方便对于资产的监控

2.提前预备好外部服务器、如做反弹shell时、不确定防火墙具体检测规则，被标记。此时要使用不具备整体攻击架构服务器的特征、做到匿名、无指纹使用。

3.在执行一些攻击的payload可能会收到WAF拦截，做好预期暴露的IP要与后期行动不一致。

##### 3.3.1.红队侦查

端口监控

Web应用程序监控

子域名监控

##### 3.3.2.反弹shell

匿名、无指纹

##### 3.3.3.Attack

执行一些攻击的payload（预期暴露的IP）

#### 3.4.红队核心工具

##### 3.4.1.Metasploit框架

Metasploit Framework，包含了丰富的漏洞攻击模块

##### 3.4.2.Cobalt Strike

红队网红工具之一，用来后期持久渗透，横向移动，流量隐藏，数据窃取工具

##### 3.4.3.Merlin

跨平台后持续利用 HTTP/2 C2工具

##### 3.4.4.Nishang

是一个脚本和payload的框架和集合，可以使用Powershell进行进攻型安全测试

##### 3.4.5.Gophish

功能强大的开源网络钓鱼框架

#### 3.5.保护措施

保护措施的作用：

1.主要目的：防止信息被抓取

2.解决攻击基础架构可能会存在一些位置漏洞，防止收到其他联网主机相同的攻击

3.敏感服务器防止被威胁情报平台标记，如CS Teamserver默认端口50050

4.当生活机器与渗透机器重合使用时，会产生大量个人信息，如此时机器被反打，轻则泄漏个人信息，重则影响整个团队

##### 3.5.1.隔离环境

物理机与虚拟机

生活机与工作机

##### 3.5.2.iptables限定流量

应该用于过滤不需要的流量并限制所需基础架构模块之间的流量

##### 3.5.3.ssh公钥身份验证

应仅限于公钥认证，并配置为使用受限权限的用户进行初始登陆。为了增加安全性，请考虑将双因子验证添加到SSH

做好多方位思维，做好自身保护。

#### 3.6.自动化部署

节约时间成本、防止重复造轮子。

##### 3.6.1.AWVS自定义镜像

预先制作好镜像、直接上传云

封装docker、便捷携带

编写shell脚本、自动化部署

##### 3.6.2.找到适合自己的办法

关于自动化部署，每个人都有自己的习惯，找到合适自己的，才是最好的。

### 4.Red Team 作用

目的：

测出公司应对入侵事情的真实状况，并找到安全计划中的问题和员工对安全项目的理解中的不足，最终提高他们对安全计划的理解。

增强蓝队团队流程，政策，工具和技能等方面。

推动管理者使其摆脱依赖审计指标的心态，使公司的程序更安全成熟。

## **免费领取安全学习资料包！**<img alt="" height="768" src="https://img-blog.csdnimg.cn/direct/eada421984c74acd858d9b2fbc7dd2cf.png" width="1024"/>

渗透工具

技术文档、书籍

<img alt="" height="516" src="https://img-blog.csdnimg.cn/direct/b7e9d2b2a1f24125b18c5fb14cf3eb68.png" width="852"/> <img alt="" height="523" src="https://img-blog.csdnimg.cn/direct/5e5cfe5b6678461e9078803c438593e9.png" width="856"/>

面试题

帮助你在面试中脱颖而出

视频

基础到进阶

环境搭建、HTML，PHP，MySQL基础学习，信息收集，SQL注入,XSS，CSRF，暴力破解等等

<img alt="" height="481" src="https://img-blog.csdnimg.cn/direct/dce4131e498d44059e25199e43529cf9.png" width="694"/> <img alt="" height="77" src="https://img-blog.csdnimg.cn/direct/7afb6bed33544fd0add2e095732fa471.png" width="665"/>

应急响应笔记

学习路线
