# 原创
：  27-1 文件上传漏洞基础

# 27-1 文件上传漏洞基础

#### 一、文件上传漏洞定义：

        文件上传漏洞指的是用户通过文件上传功能模块向服务器上传文件时，如果服务端没有对上传文件进行严格的验证和过滤，导致用户可以越过权限上传可执行的动态脚本文件。攻击者可以通过上传恶意文件如木马或Webshell，经过web容器解析，对服务器进行攻击造成损害。

#### 二、漏洞产生原因：

1. 没有对上传文件进行严格安全校验
1. 服务器配置不当
1. 过滤不严格
1. 没有对上传文件进行限制
1. 中间件存在解析漏洞
1. 绕过本地文件上传限制
1. 文件路径截断

#### 三、漏洞危害：

1. 上传包含web脚本语言的文件，经过服务器的web容器解析执行，可能导致远程代码执行。
1. 上传Flash策略文件如crossdomain.xml，黑客可控制Flash在该域下的行为，类似情况可用于控制其他策略文件。
1. 上传病毒或木马文件，诱导用户或管理员下载执行，进行挖矿等恶意活动。
1. 上传钓鱼图片或包含脚本的图片，用于进行钓鱼和欺诈活动。
1. 利用文件上传漏洞的不常见方法，通过上传一个包含PHP脚本的合法文本文件，在利用本地文件包含漏洞执行此脚本。

#### 四、文件上传流程：

<li> 客户端通过表单上传文件到服务器。
</li>
<li> 客户端通过表单上传文件到服务器。
</li>
