# 原创
：  21-5 PHP反序列化漏洞-POP链构造

# 21-5 PHP反序列化漏洞-POP链构造

#### POP链构造

POP链（Property-Oriented Programming）是一种常用于构造特定调用链的方法，用于从现有运行环境中寻找一系列代码或指令调用。它的目的是构成一组连续的调用链，最终达到攻击者恶意利用的目的。POP链实质上是通过控制对象的可控属性来控制程序的执行流程，从而利用本身无害的代码进行有害操作。

简单理解POP链的过程如下：

1. 理解程序的执行思路，确定目标函数或类。
1. 找出程序中存在的函数和类之间的调用关系。
1. 通过操控某个函数或类的属性，间接地操控目标函数或类的行为。
1. 利用这个间接控制来执行目标函数，实现特定的攻击操作，比如读取文件内容。

举例来说，假设有以下调用关系：A --&gt; B，B --&gt; C，A --&gt; B --&gt; C。在这个例子中，函数和类之间的执行依赖于调用关系。通过操纵A的属性，可以间接地操纵C的行为。

构造POP链需要对程序的执行逻辑有清晰的理解，同时需要分析和了解函数和类之间的调用关系。通过合理地操纵属性值，就可以控制程序的执行流程，从而实现攻击者的恶意目的，比如读取文件内容等。

#### 实战

**靶场地址：**[https://buuoj.cn/challenges#[MRCTF2020]Ezpop](https://buuoj.cn/challenges#%5BMRCTF2020%5DEzpop)

**读代码的思路：**
