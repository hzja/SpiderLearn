# 原创
：  28-2 文件上传漏洞 - 双写绕过

# 28-2 文件上传漏洞 - 双写绕过

环境准备：[构建完善的安全渗透测试环境：推荐工具、资源和下载链接_渗透测试靶机下载-CSDN博客](https://blog.csdn.net/weixin_43263566/article/details/129031187)

#### 一、双写绕过原理

        在代码编写过程中，双写绕过原理指的是只对黑名单中的内容进行一次空替换。由于只进行一次替换，导致了双写绕过的情况。具体来说，这种绕过技术可以通过在文件名后面添加额外的字符来实现。例如，将黑名单中的后缀名替换为空，而实际上添加了额外的字符（比如"pph"），使得最终文件后缀名变为`.pphphp`。这种方法利用了只替换一次的特性，在绕过黑名单检测的同时保留了原本的文件类型（如`.php`）。

#### 二、绕过演示（upload-labs 靶场的第10关）

正常的上传一个php文件看看

查看一下源码

使用bp抓包进行绕过，在文件名后缀的前面加上 `pph`

 <img alt="" height="727" src="https://img-blog.csdnimg.cn/direct/4fb8d99c2982434db0459131dd39ee8a.png" width="1200"/>
