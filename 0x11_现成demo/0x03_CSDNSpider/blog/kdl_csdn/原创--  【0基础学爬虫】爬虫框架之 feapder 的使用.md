# åŽŸåˆ›
ï¼š  ã€0åŸºç¡€å­¦çˆ¬è™«ã€‘çˆ¬è™«æ¡†æž¶ä¹‹ feapder çš„ä½¿ç”¨

# ã€0åŸºç¡€å­¦çˆ¬è™«ã€‘çˆ¬è™«æ¡†æž¶ä¹‹ feapder çš„ä½¿ç”¨

### å‰è¨€

å¤§æ•°æ®æ—¶ä»£ï¼Œå„è¡Œå„ä¸šå¯¹æ•°æ®é‡‡é›†çš„éœ€æ±‚æ—¥ç›Šå¢žå¤šï¼Œç½‘ç»œçˆ¬è™«çš„è¿ç”¨ä¹Ÿæ›´ä¸ºå¹¿æ³›ï¼Œè¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹å­¦ä¹ ç½‘ç»œçˆ¬è™«è¿™é¡¹æŠ€æœ¯ï¼ŒKå“¥çˆ¬è™«æ­¤å‰å·²ç»æŽ¨å‡ºä¸å°‘çˆ¬è™«è¿›é˜¶ã€é€†å‘ç›¸å…³æ–‡ç« ï¼Œä¸ºå®žçŽ°ä»Žæ˜“åˆ°éš¾å…¨æ–¹ä½è¦†ç›–ï¼Œç‰¹è®¾ã€0åŸºç¡€å­¦çˆ¬è™«ã€‘ä¸“æ ï¼Œå¸®åŠ©å°ç™½å¿«é€Ÿå…¥é—¨çˆ¬è™«ã€‚

å­¦ä¹ çˆ¬è™«çš„è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬éƒ½ä¼šæŽ¥è§¦åˆ°ä¸€äº›æ¡†æž¶ï¼Œå¸¸è§çš„æ¯”å¦‚ Scrapyã€Pyspider ç­‰ç­‰ï¼Œä¸åŒçš„æ¡†æž¶éƒ½æœ‰ç€å„è‡ªçš„ç‰¹ç‚¹ã€‚ä¸è¿‡å°±ä¸Šè¿°ä¸¤æ¬¾çˆ¬è™«æ¡†æž¶è€Œè¨€ï¼ŒPyspider ä¹…æœªç»´æŠ¤ï¼Œä¸”å®‰è£…åˆ°ä½¿ç”¨çš„è¿‡ç¨‹è¾ƒä¸ºåŽå·ï¼›Scrapy ç”Ÿæ€è‰¯å¥½ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œä½†æ˜¯å¯¹äºŽåˆå­¦è€…æ¥è¯´ï¼Œå­¦ä¹ æˆæœ¬ç›¸å¯¹è¾ƒé«˜ã€‚feapder æ¡†æž¶è¿‘å¹´æ¥è¾ƒä¸ºç«çƒ­ï¼Œæ­£å¥½ä¹Ÿæœ‰ç¾¤å‹æåˆ°äº†ï¼š

å› æ­¤ï¼Œæœ¬æœŸå°†è®²è§£ä¸€æ¬¾ä¸Šæ‰‹æ›´ä¸ºç®€å•ï¼ŒåŠŸèƒ½åŒæ ·å¼ºå¤§çš„çˆ¬è™«æ¡†æž¶ â€”â€” feapderã€‚

### ç®€ä»‹

feapder æ˜¯ä¸€æ¬¾ä¸Šæ‰‹ç®€å•ï¼ŒåŠŸèƒ½å¼ºå¤§çš„ Python çˆ¬è™«æ¡†æž¶ã€‚å†…ç½® AirSpiderã€Spiderã€TaskSpiderã€BatchSpider å››ç§çˆ¬è™«è§£å†³ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼š

feapder æ”¯æŒæ–­ç‚¹ç»­çˆ¬ã€ç›‘æŽ§æŠ¥è­¦ã€æµè§ˆå™¨æ¸²æŸ“ã€æµ·é‡æ•°æ®åŽ»é‡ç­‰åŠŸèƒ½ã€‚æ›´æœ‰åŠŸèƒ½å¼ºå¤§çš„çˆ¬è™«ç®¡ç†ç³»ç»Ÿ Feaplat ä¸ºå…¶æä¾›æ–¹ä¾¿çš„éƒ¨ç½²åŠè°ƒåº¦ã€‚

feapder å®˜æ–¹èµ„æ–™ï¼š

> 
GitHubï¼šhttps://github.com/Boris-code/feapder
å®˜æ–¹æ–‡æ¡£ï¼šhttps://feapder.com/
å®˜æ–¹å…¬ä¼—å·ï¼šfeaderçˆ¬è™«æ•™ç¨‹


### æž¶æž„è®¾è®¡

#### å®˜æ–¹æ¡†æž¶æµç¨‹å›¾

#### æ¨¡å—è¯´æ˜Ž

#### æµç¨‹è¯´æ˜Ž

æ ¹æ®ä¸Šæ–‡æ¡†æž¶æµç¨‹å›¾ï¼ŒæŒ‰æµç¨‹åºå·åˆ†æžåŠŸèƒ½ï¼š

> 
- spider è°ƒåº¦ start_request ç”Ÿäº§ä»»åŠ¡ï¼›- start_request ä¸‹å‘ä»»åŠ¡åˆ° request_buffer ä¸­ï¼›- spider è°ƒåº¦ request_buffer æ‰¹é‡å°†ä»»åŠ¡å­˜å‚¨åˆ°ä»»åŠ¡é˜Ÿåˆ—æ•°æ®åº“ä¸­ï¼›- spider è°ƒåº¦ collector ä»Žä»»åŠ¡é˜Ÿåˆ—ä¸­æ‰¹é‡èŽ·å–ä»»åŠ¡åˆ°å†…å­˜é˜Ÿåˆ—ï¼›- spider è°ƒåº¦ parser_control ä»Ž collector çš„å†…å­˜é˜Ÿåˆ—ä¸­èŽ·å–ä»»åŠ¡ï¼›- parser_control è°ƒåº¦ request è¯·æ±‚æ•°æ®ï¼›- request è¯·æ±‚ä¸Žä¸‹è½½æ•°æ®ï¼›- request å°†ä¸‹è½½åŽçš„æ•°æ®ç»™ responseï¼Œè¿›ä¸€æ­¥å°è£…ï¼›- å°†å°è£…å¥½çš„ response è¿”å›žç»™ parser_controlï¼ˆå›¾ç¤ºä¸ºå¤šä¸ª parser_controlï¼Œè¡¨ç¤ºå¤šçº¿ç¨‹ï¼‰ï¼›- parser_control è°ƒåº¦å¯¹åº”çš„ parserï¼Œè§£æžè¿”å›žçš„ responseï¼ˆå›¾ç¤ºå¤šç»„ parser è¡¨ç¤ºä¸åŒçš„ç½‘ç«™è§£æžå™¨ï¼‰ï¼›- parser_control å°† parser è§£æžåˆ°çš„æ•°æ® item åŠæ–°äº§ç”Ÿçš„ request åˆ†å‘åˆ° item_buffer ä¸Ž request_bufferï¼›- spider è°ƒåº¦ item_buffer ä¸Ž request_buffer å°†æ•°æ®æ‰¹é‡å…¥åº“ã€‚


### feapder çš„ä½¿ç”¨

#### çŽ¯å¢ƒ

#### å®‰è£…

â‘  ç²¾ç®€ç‰ˆ

```
pip install feapder

```

ä¸æ”¯æŒæµè§ˆå™¨æ¸²æŸ“ã€ä¸æ”¯æŒåŸºäºŽå†…å­˜åŽ»é‡ã€ä¸æ”¯æŒå…¥åº“ mongoã€‚

â‘¡ æµè§ˆå™¨æ¸²æŸ“ç‰ˆ

```
pip install "feapder[render]"

```

ä¸æ”¯æŒåŸºäºŽå†…å­˜åŽ»é‡ã€ä¸æ”¯æŒå…¥åº“ mongoã€‚

â‘¢ å®Œæ•´ç‰ˆ

```
pip install "feapder[all]"

```

æ”¯æŒæ‰€æœ‰åŠŸèƒ½ã€‚

å¸¸è§å®‰è£…é—®é¢˜ï¼š

> 
https://feapder.com/#/question/%E5%AE%89%E8%A3%85%E9%97%AE%E9%A2%98


å®‰è£…æˆåŠŸï¼ŒæŸ¥çœ‹ç‰ˆæœ¬åŠå¯ç”¨å‘½ä»¤ï¼š

feapder æ”¯æŒ `create`ã€`retry`ã€`shell` åŠ `zip` å››ç§å‘½ä»¤ï¼Œ`feapder &lt;command&gt; -h` æŸ¥çœ‹ä½¿ç”¨å¸®åŠ©ã€‚

è¯¦ç»†èµ„æ–™ï¼š

> 
https://feapder.com/#/command/cmdline


#### AirSpider

è½»é‡çˆ¬è™«ï¼Œå­¦ä¹ æˆæœ¬ä½Žï¼Œé¢å¯¹ä¸€äº›æ•°æ®é‡è¾ƒå°‘ï¼Œæ— éœ€æ–­ç‚¹ç»­çˆ¬ï¼Œæ— éœ€åˆ†å¸ƒå¼é‡‡é›†çš„éœ€æ±‚ï¼Œå¯é‡‡ç”¨æ­¤çˆ¬è™«ã€‚

**â‘  åˆ›å»ºçˆ¬è™«é¡¹ç›®**

å‘½ä»¤å¦‚ä¸‹ï¼š

```
feapder create -p &lt;project_name&gt;

```

å’Œ Scrapy ä¸€æ ·ï¼Œåˆ›å»ºæ–°é¡¹ç›®æ—¶ï¼Œä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ç³»åˆ—çš„æ–‡ä»¶å’Œç›®å½•ç»“æž„ï¼Œæœ‰åŠ©äºŽç†è§£ä¸Žä½¿ç”¨æ¡†æž¶ï¼š

ç›¸å…³æ–‡ä»¶ç®€ä»‹ï¼š

**â‘¡ åˆ›å»ºçˆ¬è™«ç¨‹åº**

å‘½ä»¤å¦‚ä¸‹ï¼š

```
feapder create -s &lt;spider_name&gt;

```

é€‰æ‹©éœ€è¦åˆ›å»ºçš„çˆ¬è™«æ¨¡æ¿ï¼ŒæŒ‰ä¸Šä¸‹é”®æ›´æ¢æ¨¡ç‰ˆï¼Œè¿™é‡Œé€‰æ‹© AirSpider æ¨¡æ¿ï¼Œå›žè½¦å³å¯åˆ›å»ºæˆåŠŸï¼š

ä»£ç æ ·ä¾‹å¦‚ä¸‹ï¼š

```
# -*- coding: utf-8 -*-
"""
Created on xxx
---------
@summary:
---------
@author: kg_spider
"""

import feapder
from loguru import logger


class FeapderSpiderDemo(feapder.AirSpider):
    def start_requests(self):
        yield feapder.Request("https://www.kuaidaili.com/free")

    def parse(self, request, response):
        # æå–ç½‘ç«™ title
        logger.info(response.xpath("//title/text()").extract_first())
        # æå–ç½‘ç«™æè¿°
        logger.info(f"ç½‘ç«™åœ°å€: {response.url}")


if __name__ == "__main__":
    FeapderSpiderDemo().start()

```

è¿è¡Œç»“æžœï¼š

å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤ä¼šè¾“å‡ºè¯·æ±‚é“¾æŽ¥ï¼ˆurlï¼‰ã€è¯·æ±‚æ–¹å¼ï¼ˆmethodï¼‰ä»¥åŠè¯·æ±‚å¤´ç›¸å…³ä¿¡æ¯ï¼ˆargsï¼‰ï¼Œä¸éœ€è¦çš„å¯ä»¥è·Ÿè¿›åˆ° `requests.py` æ–‡ä»¶ä¸­ï¼Œå°† log éƒ¨åˆ†æ³¨é‡ŠæŽ‰å³å¯ï¼š

**â‘¢ AirSpider çš„åŸºæœ¬ä½¿ç”¨æ–¹æ³•**

å¦‚æžœéœ€è¦è§£æžçš„å‡½æ•°ä¸æ­¢ä¸€ä¸ªçš„è¯ï¼Œå¯ä»¥è‡ªå®šä¹‰è§£æžå‡½æ•°ï¼ˆé»˜è®¤å¤±è´¥é‡è¯• 10 æ¬¡ï¼‰ã€ä¸‹è½½ä¸­é—´ä»¶ï¼ˆcookiesã€headers ç­‰ï¼‰ä»¥åŠå¤±è´¥é‡è¯•ç­‰ç­‰ï¼Œå›Šæ‹¬åœ¨ä¸‹é¢çš„ä»£ç æ ·ä¾‹ä¸­ï¼š

```
# -*- coding: utf-8 -*-
"""
Created on xxx
---------
@summary:
---------
@author: kg_spider
"""

import feapder
from loguru import logger


class FeapderSpiderDemo(feapder.AirSpider):
    # è‡ªå®šä¹‰é…ç½®é¡¹
    __custom_setting__ = dict(
        SPIDER_MAX_RETRY_TIMES=5,
    )
    
    def start_requests(self):
        yield feapder.Request("https://www.baidu.com", download_midware=self.download_midware)  # ä¸æŒ‡å®š callback, ä»»åŠ¡ä¼šè°ƒåº¦é»˜è®¤çš„ parser ä¸Š
        yield feapder.Request("https://www.kuaidaili.com/free", callback=self.spider_kdl)  # æŒ‡å®šäº† callback, ä»»åŠ¡ç”± callback æŒ‡å®šçš„å‡½æ•°è§£æž

    def download_midware(self, request):
        """
        ä¸‹è½½ä¸­é—´ä»¶

        åœ¨è¯·æ±‚ä¹‹å‰, å¯¹è¯·æ±‚åšä¸€äº›å¤„ç†, å¦‚æ·»åŠ  cookieã€header ç­‰
        """
        # æ·»åŠ  headers
        request.headers = {
            'User-Agent': "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 Edg/126.0.0.0"
        }
        return request

    def parse(self, request, response):
        # æå–ç½‘ç«™ title
        logger.info(response.xpath("//title/text()").extract_first())
        # æå–ç½‘ç«™æè¿°
        logger.info(f"ç½‘ç«™åœ°å€: {response.url}")
        # å¼‚å¸¸é‡è¯•
        if response.status_code != 200:
            raise Exception("æœªæ­£å¸¸èŽ·å–åˆ°æœ‰æ•ˆé¡µé¢")

    @staticmethod
    def spider_kdl(request, response):
        # æå–ç½‘ç«™ title
        logger.info(response.xpath("//title/text()").extract_first())
        # æå–ç½‘ç«™æè¿°
        logger.info(f"ç½‘ç«™åœ°å€: {response.url}")


if __name__ == "__main__":
    FeapderSpiderDemo().start()

```

è¿è¡Œç»“æžœï¼š

feapder æ¡†æž¶å†…ç½®äº†èƒ½å¤Ÿåœæ­¢æ•´ä¸ªçˆ¬è™«ç¨‹åºçš„æ–¹æ³•ï¼š

```
import feapder


class AirTest(feapder.AirSpider):
    def start_requests(self):
        yield feapder.Request("https://www.kuaidaili.com/free")

    def parse(self, request, response):
        self.stop_spider()  # åœæ­¢çˆ¬è™«ï¼Œå¯ä»¥åœ¨ä»»æ„åœ°æ–¹è°ƒç”¨è¯¥æ–¹æ³•


if __name__ == "__main__":
    AirTest().start()

```

**â‘£ æ•°æ®å…¥åº“**

feapder æ¡†æž¶å†…å°è£…äº† `MysqlDB`ã€`RedisDB`ï¼Œä¸Ž pymysql ä¸åŒçš„æ˜¯ï¼ŒMysqlDB ä½¿ç”¨äº†çº¿ç¨‹æ± ï¼Œä¸”å¯¹æ–¹æ³•è¿›è¡Œäº†å°è£…ï¼Œä½¿ç”¨èµ·æ¥æ›´æ–¹ä¾¿ï¼š

MysqlDB å…·æœ‰æ–­å¼€è‡ªåŠ¨é‡è¿žç‰¹æ€§ï¼Œæ”¯æŒå¤šçº¿ç¨‹ä¸‹æ“ä½œï¼Œå†…ç½®è¿žæŽ¥æ± ï¼Œæœ€å¤§è¿žæŽ¥æ•° 100ã€‚åŒæ—¶ï¼Œå°è£…äº†å¢žåˆ æ”¹æŸ¥ç­‰æ–¹æ³•ï¼Œä½¿ç›¸å…³æ“åšæ›´ä¸ºæ–¹ä¾¿ï¼Œå¯è‡ªè¡Œæµ‹è¯•ã€‚

> 
MysqlDBï¼šhttps://feapder.com/#/source_code/MysqlDB


RedisDB æ”¯æŒæ™®é€šæ¨¡å¼ï¼ˆå•èŠ‚ç‚¹ï¼‰ã€å“¨å…µæ¨¡å¼ã€é›†ç¾¤æ¨¡å¼ï¼š

> 
RedisDBï¼šhttps://feapder.com/#/source_code/RedisDB


åŸºæœ¬ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š

```
import feapder
from feapder.db.mysqldb import MysqlDB
from feapder.db.redisdb import RedisDB

class AirSpiderTest(feapder.AirSpider):
    __custom_setting__ = dict(
        MYSQL_IP="localhost",
        MYSQL_PORT = 3306,
        MYSQL_DB = "kgspider",
        MYSQL_USER_NAME = "spider123",
        MYSQL_USER_PASS = "123456"
    )
    
    
def __init__(self, *args, **kwargs):
    super().__init__(*args, **kwargs)
    self.db = MysqlDB()


```

**â‘¤ çº¿ç¨‹æ•°é…ç½®**

æ¡†æž¶é»˜è®¤çš„çº¿ç¨‹æ•°ä¸º 1ï¼Œä½†åœ¨æ­£å¸¸ä¸šåŠ¡ä¸­ï¼ŒåŸºæœ¬ä¸å¯èƒ½åªé‡‡ç”¨å•çº¿ç¨‹çš„å·¥ä½œæ–¹å¼è¿›è¡Œæ•°æ®é‡‡é›†ï¼Œfeapder çš„å¤šçº¿ç¨‹é…ç½®æœ‰å‡ ç§æ–¹å¼ï¼š

1ã€åœ¨å¯åŠ¨å‡½æ•°ä¸­ä¼ é€’çº¿ç¨‹æ•°ï¼š

```
if __name__ == "__main__":
    AirSpiderTest(thread_count=10).start()


```

2ã€åœ¨é…ç½®æ–‡ä»¶ setting.py ä¸­æ›´æ”¹å¯¹åº”çš„é…ç½®é¡¹ï¼š

```
SPIDER_THREAD_COUNT = 1  # çˆ¬è™«å¹¶å‘æ•°ï¼Œè¿½æ±‚é€Ÿåº¦æŽ¨è 32


```

3ã€ åœ¨ç¨‹åºè„šæœ¬ä¸­ï¼Œä½¿ç”¨ç±»å˜é‡ `__custom_setting__` è‡ªå®šä¹‰é…ç½®é¡¹ï¼š

```
import feapder


class SpiderTest(feapder.AirSpider):
    __custom_setting__ = dict(
        SPIDER_THREAD_COUNT=10,
    )


```

åœ¨ç¨‹åºè„šæœ¬ä¸­è‡ªå®šä¹‰é…ç½®é¡¹ï¼Œä¼˜å…ˆçº§ä¼šå¤§äºŽåœ¨ setting.py ä¸­è®¾ç½®ã€‚

feapder æ¡†æž¶è¿˜æ”¯æŒæµè§ˆå™¨ï¼ˆChromeã€Edgeã€PhantomJSã€Firefoxï¼‰æ¸²æŸ“é‡‡é›†ï¼ˆè‡ªåŠ¨åŒ–ï¼‰çš„æ–¹å¼ï¼ŒåŠŸèƒ½å¾ˆå…¨é¢ï¼š

```
# æµè§ˆå™¨æ¸²æŸ“
WEBDRIVER = dict(
    pool_size=1,  # æµè§ˆå™¨çš„æ•°é‡
    load_images=True,  # æ˜¯å¦åŠ è½½å›¾ç‰‡
    user_agent=None,  # å­—ç¬¦ä¸² æˆ– æ— å‚å‡½æ•°ï¼Œè¿”å›žå€¼ä¸º user_agent
    proxy=None,  # xxx.xxx.xxx.xxx:xxxx æˆ– æ— å‚å‡½æ•°ï¼Œè¿”å›žå€¼ä¸ºä»£ç†åœ°å€
    headless=False,  # æ˜¯å¦ä¸ºæ— å¤´æµè§ˆå™¨
    driver_type="CHROME",  # CHROMEã€EDGEã€PHANTOMJSã€FIREFOX
    timeout=30,  # è¯·æ±‚è¶…æ—¶æ—¶é—´
    window_size=(1024, 800),  # çª—å£å¤§å°
    executable_path=None,  # æµè§ˆå™¨è·¯å¾„ï¼Œé»˜è®¤ä¸ºé»˜è®¤è·¯å¾„
    render_time=0, # æ¸²æŸ“æ—¶é•¿ï¼Œå³æ‰“å¼€ç½‘é¡µç­‰å¾…æŒ‡å®šæ—¶é—´åŽå†èŽ·å–æºç 
    custom_argument=["--ignore-certificate-errors"],  # è‡ªå®šä¹‰æµè§ˆå™¨æ¸²æŸ“å‚æ•°
    xhr_url_regexes=None,  # æ‹¦æˆª xhr æŽ¥å£ï¼Œæ”¯æŒæ­£åˆ™ï¼Œæ•°ç»„ç±»åž‹
    auto_install_driver=False,  # è‡ªåŠ¨ä¸‹è½½æµè§ˆå™¨é©±åŠ¨ æ”¯æŒ chrome å’Œ firefox
)


```

> 
ç›¸å…³æ–‡æ¡£ï¼šhttps://feapder.com/#/source_code/%E6%B5%8F%E8%A7%88%E5%99%A8%E6%B8%B2%E6%9F%93-Selenium


æ›´è¯¦ç»†çš„åŠŸèƒ½ä»‹ç»ï¼ŒæŽ¨èé˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼Œå°±ä¸åœ¨æ­¤èµ˜è¿°äº†ï¼š

> 
AirSpiderï¼šhttps://feapder.com/#/usage/AirSpider
Requestï¼šhttps://feapder.com/#/source_code/Request
Responseï¼šhttps://feapder.com/#/source_code/Response


#### Spider

Spider æ˜¯ä¸€æ¬¾åŸºäºŽ redis çš„åˆ†å¸ƒå¼çˆ¬è™«ï¼Œé€‚ç”¨äºŽæµ·é‡æ•°æ®é‡‡é›†ï¼Œæ”¯æŒæ–­ç‚¹ç»­çˆ¬ã€çˆ¬è™«æŠ¥è­¦ã€æ•°æ®è‡ªåŠ¨å…¥åº“ç­‰åŠŸèƒ½ã€‚

**â‘  åˆ›å»ºçˆ¬è™«é¡¹ç›®**

ä¸Ž AirSpider ç›¸åŒï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š

```
feapder create -p &lt;project_name&gt;


```

**â‘¡ åˆ›å»ºçˆ¬è™«ç¨‹åº**

å‘½ä»¤å¦‚ä¸‹ï¼š

```
feapder create -s &lt;spider_name&gt;


```

é€‰æ‹©éœ€è¦åˆ›å»ºçš„çˆ¬è™«æ¨¡æ¿ï¼ŒæŒ‰ä¸Šä¸‹é”®æ›´æ¢æ¨¡ç‰ˆï¼Œè¿™é‡Œé€‰æ‹© Spider æ¨¡æ¿ï¼Œå›žè½¦å³å¯åˆ›å»ºæˆåŠŸï¼š

ä»£ç æ ·ä¾‹å¦‚ä¸‹ï¼Œé»˜è®¤ç»™äº† redis çš„é…ç½®æ–¹å¼ï¼Œè¿žæŽ¥ä¿¡æ¯éœ€æŒ‰çœŸå®žæƒ…å†µä¿®æ”¹ï¼š

```
# -*- coding: utf-8 -*-
"""
Created on xxx
---------
@summary:
---------
@author: kg_spider
"""

import feapder


class FeapderSpiderDemo(feapder.Spider):
    # è‡ªå®šä¹‰æ•°æ®åº“ï¼Œè‹¥é¡¹ç›®ä¸­æœ‰ setting.py æ–‡ä»¶ï¼Œæ­¤è‡ªå®šä¹‰å¯åˆ é™¤
    __custom_setting__ = dict(
        REDISDB_IP_PORTS="localhost:6379", REDISDB_USER_PASS="", REDISDB_DB=0
    )

    def start_requests(self):
        yield feapder.Request("https://www.kuaidaili.com/free")

    def parse(self, request, response):
        # æå–ç½‘ç«™ title
        print(response.xpath("//title/text()").extract_first())


if __name__ == "__main__":
    # åˆ›å»ºçˆ¬è™«å®žä¾‹å¹¶å¯åŠ¨çˆ¬è™«
    # redis_key ç”¨äºŽåœ¨ Redis ä¸­å­˜å‚¨è¯·æ±‚é˜Ÿåˆ—å’Œå…¶ä»–ä»»åŠ¡ç›¸å…³ä¿¡æ¯
    FeapderSpiderDemo(redis_key="xxx:xxx").start()


```

é…ç½®ä¿¡æ¯ï¼š

Spider æ”¯æŒæ–­ç‚¹ç»­çˆ¬ï¼Œå…¶åˆ©ç”¨äº† redis æœ‰åºé›†åˆæ¥å­˜å‚¨ä»»åŠ¡ï¼Œæœ‰åºé›†åˆæœ‰ä¸ªåˆ†æ•°ï¼Œçˆ¬è™«å–ä»»åŠ¡æ—¶ï¼Œåªå–å°äºŽå½“å‰æ—¶é—´æˆ³åˆ†æ•°çš„ä»»åŠ¡ï¼ŒåŒæ—¶å°†ä»»åŠ¡åˆ†æ•°ä¿®æ”¹ä¸ºå½“å‰æ—¶é—´æˆ³ +10 åˆ†é’Ÿï¼ˆå¯è‡ªè¡Œé…ç½®ï¼‰ï¼Œï¼ˆè¿™ä¸ªå–ä»»åŠ¡ä¸Žæ”¹åˆ†æ•°æ˜¯åŽŸå­æ€§çš„æ“ä½œï¼‰ã€‚å½“ä»»åŠ¡åšå®Œæ—¶ï¼Œä¸”æ•°æ®å·²å…¥åº“åŽï¼Œå†ä¸»åŠ¨å°†ä»»åŠ¡åˆ é™¤ã€‚

Spider ä»»åŠ¡è¯·æ±‚å¤±è´¥æˆ–è§£æžå‡½æ•°æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨é‡è¯•ï¼Œé»˜è®¤é‡è¯•æ¬¡æ•°ä¸º 100 æ¬¡ï¼ˆå¯è‡ªè¡Œé…ç½®ï¼‰ã€‚å½“ä»»åŠ¡è¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°æ—¶ï¼Œé»˜è®¤ä¼šå°†å¤±è´¥çš„ä»»åŠ¡å­˜å‚¨åˆ° redis çš„ {redis_key}ðŸ˜’_failed_requsets é‡Œï¼Œä»¥ä¾›æŽ’æŸ¥ã€‚

æ›´è¯¦ç»†çš„åŠŸèƒ½ä»‹ç»ï¼Œå»ºè®®é˜…è¯»å®˜æ–¹æ–‡æ¡£ï¼š

> 
Spiderï¼šhttps://feapder.com/#/usage/Spider
Spider è¿›é˜¶ï¼šhttps://feapder.com/#/source_code/Spider%E8%BF%9B%E9%98%B6


#### TaskSpiderã€BatchSpider

**TaskSpider**ï¼šä¸€æ¬¾åˆ†å¸ƒå¼çˆ¬è™«ï¼Œå†…éƒ¨å°è£…äº†å–ç§å­ä»»åŠ¡çš„é€»è¾‘ï¼Œå†…ç½®æ”¯æŒä»Ž redis æˆ–è€… mysql èŽ·å–ä»»åŠ¡ï¼Œä¹Ÿå¯é€šè¿‡è‡ªå®šä¹‰å®žçŽ°ä»Žå…¶ä»–æ¥æºèŽ·å–ä»»åŠ¡ã€‚

**BatchSpider**ï¼šä¸€æ¬¾åˆ†å¸ƒå¼æ‰¹æ¬¡çˆ¬è™«ï¼Œå¯¹äºŽéœ€è¦å‘¨æœŸæ€§é‡‡é›†çš„æ•°æ®ï¼Œä¼˜å…ˆè€ƒè™‘ä½¿ç”¨æœ¬çˆ¬è™«ã€‚ä¼šè‡ªåŠ¨ç»´æŠ¤ä¸ªæ‰¹æ¬¡ä¿¡æ¯è¡¨ï¼Œè¯¦ç»†çš„è®°å½•äº†æ¯ä¸ªæ‰¹æ¬¡æ—¶é—´ã€ä»»åŠ¡å®Œæˆæƒ…å†µã€æ‰¹æ¬¡å‘¨æœŸç­‰ä¿¡æ¯ã€‚ä¼šç»´æŠ¤ä¸ªæ‰¹æ¬¡æ—¶é—´ä¿¡æ¯ï¼Œæœ¬æ‰¹æ¬¡æœªå®Œæˆä¸‹ä¸€æ‰¹æ¬¡ä¸ä¼šå¼€å§‹ã€‚

å››ç§çˆ¬è™«æ¨¡æ¿ï¼šAirSpider -&gt; Spider -&gt; TaskSpider -&gt; BatchSpiderï¼ŒåŽä¸€ç§éƒ½æ˜¯åŸºäºŽå‰ä¸€ç§çš„ä¼˜åŒ–ï¼Œå…·ä½“çš„ä½¿ç”¨è¯´æ˜Žï¼Œå®˜æ–¹æ–‡æ¡£éƒ½å†™çš„å¾ˆæ¸…æ¥šäº†ï¼š

> 
TaskSpiderï¼šhttps://feapder.com/#/usage/TaskSpider
BatchSpiderï¼šhttps://feapder.com/#/usage/BatchSpider


#### æ•°æ®ç›‘æŽ§

feapder è¿˜æœ‰é…å¥—çš„çˆ¬è™«ç®¡ç†ç³»ç»Ÿ ------ feaplatï¼ˆæš‚æ—¶ä¸æ”¯æŒ Apple èŠ¯ç‰‡ï¼‰ï¼Œå¯ä»¥é€šè¿‡ docker å®‰è£…éƒ¨ç½²ï¼š

> 
https://feapder.com/#/feapder_platform/feaplat


feapder å†…ç½®ç›‘æŽ§æ‰“ç‚¹ï¼ˆfeapder ç‰ˆæœ¬å¤§äºŽç­‰äºŽ 1.6.6ï¼‰ï¼Œéƒ¨ç½²åˆ° feaplat çˆ¬è™«ç®¡ç†ç³»ç»Ÿå³å¯å®žçŽ°å¯¹è¯·æ±‚å’Œæ•°æ®ç›‘æŽ§ï¼š

> 
ç›‘æŽ§æ‰“ç‚¹ï¼šhttps://feapder.com/#/source_code/%E7%9B%91%E6%8E%A7%E6%89%93%E7%82%B9

