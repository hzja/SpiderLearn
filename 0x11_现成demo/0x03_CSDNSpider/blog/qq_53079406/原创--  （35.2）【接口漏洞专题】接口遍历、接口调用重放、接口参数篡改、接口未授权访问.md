# 原创
：  （35.2）【接口漏洞专题】接口遍历、接口调用重放、接口参数篡改、接口未授权访问

# （35.2）【接口漏洞专题】接口遍历、接口调用重放、接口参数篡改、接口未授权访问

**目录**

[一、接口调用遍历：](#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E9%81%8D%E5%8E%86%EF%BC%9A)

[1.1、原理：](#%E5%8E%9F%E7%90%86%EF%BC%9A)

[1.1.1、初期](#%EF%BC%881%EF%BC%89%E5%88%9D%E6%9C%9F)

[1.1.2、编码](#%EF%BC%882%EF%BC%89%E7%BC%96%E7%A0%81)

[1.1.3、实现](#%EF%BC%883%EF%BC%89%E5%AE%9E%E7%8E%B0)

[1.2、示例：](#%E7%A4%BA%E4%BE%8B%EF%BC%9A)

[1.3、漏洞产生的原因：](#%E6%BC%8F%E6%B4%9E%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%9A)

[1.3.1、明文传输：](#%EF%BC%881%EF%BC%89%E6%98%8E%E6%96%87%E4%BC%A0%E8%BE%93%EF%BC%9A)

[1.3.2、无Session检验：](#%EF%BC%882%EF%BC%89%E6%97%A0Session%E6%A3%80%E9%AA%8C%EF%BC%9A)

[1.4、利用过程：](#%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%9A)

[1.4.1、抓包拦截](#%EF%BC%881%EF%BC%89%E6%8A%93%E5%8C%85%E6%8B%A6%E6%88%AA)

[1.4.2、产生数据包](#%EF%BC%882%EF%BC%89%E4%BA%A7%E7%94%9F%E6%95%B0%E6%8D%AE%E5%8C%85)

[1.4.3、过滤数据包](#%EF%BC%883%EF%BC%89%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE%E5%8C%85)

[1.4.4、接口遍历](#%EF%BC%884%EF%BC%89%E6%8E%A5%E5%8F%A3%E9%81%8D%E5%8E%86)

[二、接口调用重放：](#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E9%87%8D%E6%94%BE%EF%BC%9A)

[2.1、原理：](#%E5%8E%9F%E7%90%86%EF%BC%9A)

[2.2、产生的地方：](#%E4%BA%A7%E7%94%9F%E7%9A%84%E5%9C%B0%E6%96%B9%EF%BC%9A)

[2.3、漏洞产生的原因：](#%E6%BC%8F%E6%B4%9E%E4%BA%A7%E7%94%9F%E7%9A%84%E5%8E%9F%E5%9B%A0%EF%BC%9A)

[2.4、利用过程：](#%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%9A)

[2.4.1、截取](#%EF%BC%881%EF%BC%89%E6%88%AA%E5%8F%96)

[2.4.2、重发](#%EF%BC%882%EF%BC%89%E9%87%8D%E5%8F%91)

[2.4.3、执行](#%EF%BC%883%EF%BC%89%E6%89%A7%E8%A1%8C)

[三、接口调用参数篡改：](#%E6%8E%A5%E5%8F%A3%E8%B0%83%E7%94%A8%E5%8F%82%E6%95%B0%E7%AF%A1%E6%94%B9%EF%BC%9A)

[3.1、原理：](#%E5%8E%9F%E7%90%86%EF%BC%9A)

[3.2、参数的加密：](#%E5%8F%82%E6%95%B0%E7%9A%84%E5%8A%A0%E5%AF%86%EF%BC%9A)

[3.2.1、规则](#%EF%BC%881%EF%BC%89%E8%A7%84%E5%88%99)

[3.2.2、加密](#%EF%BC%882%EF%BC%89%E5%8A%A0%E5%AF%86)

[3.2.3、发送](#%EF%BC%883%EF%BC%89%E5%8F%91%E9%80%81)

[3.2.4、解密](#%EF%BC%884%EF%BC%89%E8%A7%A3%E5%AF%86)

[3.2.5、验证](#%EF%BC%885%EF%BC%89%E9%AA%8C%E8%AF%81)

[3.3、产生漏洞原因：](#%E4%BA%A7%E7%94%9F%E6%BC%8F%E6%B4%9E%E5%8E%9F%E5%9B%A0%EF%BC%9A)

[3.4、产生的地方](#%E4%BA%A7%E7%94%9F%E7%9A%84%E5%9C%B0%E6%96%B9)

[3.5、利用过程：](#%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%9A)

[3.5.1、提交](#%E6%8F%90%E4%BA%A4%EF%BC%8C)

[3.5.2、修改](#%E4%BF%AE%E6%94%B9%EF%BC%8C)

[3.5.3、实现](#%E5%AE%9E%E7%8E%B0%EF%BC%8C)

[四、接口未授权访问：](#%E6%8E%A5%E5%8F%A3%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%EF%BC%9A)

[4.1、原理：](#%E5%8E%9F%E7%90%86%EF%BC%9A)

[4.2、产生原因：](#%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0%EF%BC%9A)

[4.2.1、未使用检验方法：](#%E6%9C%AA%E4%BD%BF%E7%94%A8%E6%A3%80%E9%AA%8C%E6%96%B9%E6%B3%95%EF%BC%9A)

[4.3、 利用过程：](#%C2%A0%E5%88%A9%E7%94%A8%E8%BF%87%E7%A8%8B%EF%BC%9A)

[4.3.1、发现](#%E5%8F%91%E7%8E%B0%EF%BC%8C)

[4.3.2、利用](#%E5%88%A9%E7%94%A8%EF%BC%8C)

[五、相关介绍](#webservice%E6%B5%8B%E8%AF%95%EF%BC%9A)

[5.1、webservice：](#5.1%E3%80%81webservice%EF%BC%9A)

[5.1.1、原理：](#5.1.1%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[5.1.2、测试链接：](#5.1.2%E3%80%81%E6%B5%8B%E8%AF%95%E9%93%BE%E6%8E%A5%EF%BC%9A)

[5.2、callback自定义：](#callback%E8%87%AA%E5%AE%9A%E4%B9%89%EF%BC%9A)

[5.2.1、原理：](#5.2.1%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[5.2.2、示例](#5.2.2%E3%80%81%E7%A4%BA%E4%BE%8B)

---


 

## 一、接口调用遍历：

### 1.1、原理：

> 
<h4>1.1.1、初期</h4>
在对功能进行设计的时候，就会相应的设计接口（方便去调用这些功能）。
<h4>1.1.2、编码</h4>
接口根据具体的功能需求进行封装（各部分可以直接调用）
<h4>1.1.3、实现</h4>
通过客户端传入的不同参数，获取对应数据，或执行相应的功能


#### 1.1.2、编码

### 1.2、示例：

> 
查询功能，客户端通过对应的接口，传入userID等相应的参数，筛选出对应userID的信息，并返回给客户端。


### 1.3、漏洞产生的原因：

> 
<h4>1.3.1、明文传输：</h4>
没有使用HTTPS等安全协议进行加密传输，直接将敏感的信息通过明文在客户端与服务器之间传输

<h4>1.3.2、无Session检验：</h4>
如果没有对userID参数与对应的Session进行一致性验证，可能存在非法的越权访问


#### 1.3.2、无Session检验：

### 1.4、利用过程：

> 
<h4>1.4.1、抓包拦截</h4>
使用burpsuite等抓包工具代理
<h4>1.4.2、产生数据包</h4>
在网站上点击各种地方（登录，查询等等），burpsuite会对整站的数据包进行爬取，并保存在site map（网站地址）中
<h4>1.4.3、过滤数据包</h4>
使用burpsuite的过滤器，对数据包进行过滤，找到含id参数的请求数据包
<h4>1.4.4、接口遍历</h4>
对于找到的数据包发送到Intruder中，对id参数进行遍历，并分析响应信息


#### 1.4.2、产生数据包

#### 1.4.4、接口遍历

---


## 二、接口调用重放：

### 2.1、原理：

> 
顾名思义，就是将截获的正常数据包，再次发送给服务器（已经接过该数据包），且能被服务器执行，重发次数多了就崩了。


### 2.2、产生的地方：

> 
支付接口、发送短信接口、发送邮件接口、验证码接口、订单生成接口、评论提交接口……


### 2.3、漏洞产生的原因：

> 
（1）未采取验证或验证不全面
（2）未控制数据包相关限制，就好比上限等（未做好输入控制）
（3）对应的唯一的token，和token使用后失效，失效时间
（4）为对数据包中的参数进行过滤，导致恶意语句执行
（5）没有判断时间戳的机制
（6）未做好输出控制


### 2.4、利用过程：

> 
<h4>2.4.1、截取</h4>
攻击者通过网络监听或抓包等方法获取到了正常的请求数据包
<h4>2.4.2、重发</h4>
虽然这个数据包已经被服务器成功接收到了，但是因为服务器验证机制漏洞，再次把数据包发送给服务器，达到欺骗服务器目的
<h4>2.4.3、执行</h4>
数据包中恶意操作被服务器执行


#### 2.4.2、重发

---


 

## 三、接口调用参数篡改：

### 3.1、原理：

> 
顾名思义，通过对漏洞的利用（或者抓包），对传入接口的参数进行修改。


### 3.2、参数的加密：

> 
<h4>3.2.1、规则</h4>
客户端和服务端约定的加密方法、加密秘钥等
<h4>3.2.2、加密</h4>
使用秘钥对参数加密（得签名值signature），将签名值放入参数中
<h4>3.2.3、发送</h4>
发送到服务器
<h4>3.2.4、解密</h4>
根据约定好的秘钥解密（得签名值autograph）
<h4>3.2.5、验证</h4>
对比2次签名值（signature和autograph的值），一样则合法，反之不合法


#### 3.2.2、加密

#### 3.2.4、解密

### 3.3、产生漏洞原因：

> 
（1）Session覆盖问题（Session中存储重要的凭证），如果是从客户请求的参数中获取相关凭证，就可能接收到是被篡改的参数
（2）从前端获取的相关凭证，要与Session中的凭证相符合
（3）没有对前后端进行分离


### 3.4、产生的地方

> 
（短信、邮政……）短信验证码、邮件验证码……


### 3.5、利用过程：

> 
<h4>3.5.1、提交</h4>
输入正确的手机号或邮箱地址参数提交
<h4>3.5.2、修改</h4>
通过Session覆盖等手段修改手机号或邮箱，改为目标手机号/邮箱
<h4>3.5.3、实现</h4>
如果修改了对应请求中参数后，修改后的目标能收到信息，则表示接口参数修改并成功执行，存在篡改漏洞


#### 3.5.2、修改

---


## 四、接口未授权访问：

### 4.1、原理：

> 
在很多功能设计的时候，特定功能的接口调用，需要进行身份验证通过后，才能调用使用特定功能，通过各种漏洞去访问无权访问的，就属于未授权。


### 4.2、产生原因：

> 
<h4>4.2.1、未使用检验方法：</h4>
（1）未使用Token验证，或者Token使用后未失效，被攻击者利用
（2）未对会话状态进行验证（即是否是登录状态）
（3）未进行Session验证（Session中包含身份凭据）
（4）未对请求者身份与所请求数据所有者是否进行验证（唯一性）


### 4.3、 利用过程：

> 
<h4>4.3.1、发现</h4>
寻找接口身份验证的不足（如未做身份验证或校验不足）
<h4>4.3.2、利用</h4>
利用漏洞（身份认证的缺陷），进行非授权访问（越权，垂直越权和水平越权）调用接口


#### 4.3.2、利用

---


 

## 五、相关介绍

### 5.1、webservice：

#### 5.1.1、原理：

> 
字面意思是web服务意思（分布式计算技术），网络上存在可用的API（接口），即可直接在网络环境进行调用的方法（远程调用）


#### 5.1.2、测试链接：

> 
[WebService测试链接](https://blog.csdn.net/qq_53079406/article/details/124184951?spm=1001.2014.3001.5501)


### 5.2、callback自定义：

#### 5.2.1、原理：

> 
被作为实参传入另一函数，并在该外部函数内被调用，用以来完成某些任务的函数，称为回调函数（官方文档）


#### 5.2.2、示例

> 
这个就是好像C语言中import&lt;&gt;一样，调用系统库里面的代码（导入模块）。

