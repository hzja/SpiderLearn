# 原创
：  【漏洞复现-Apache-后缀绕过】vulfocus/httpd-apache_parsing_vulnerability

# 【漏洞复现-Apache-后缀绕过】vulfocus/httpd-apache_parsing_vulnerability

**目录**

[一、靶场环境](#%E4%B8%80%E3%80%81%E9%9D%B6%E5%9C%BA%E7%8E%AF%E5%A2%83)

[1.1、平台：](#1.1%E3%80%81%E5%B9%B3%E5%8F%B0%EF%BC%9A)

[1.2、知识:](#1.2%E3%80%81%E6%BC%8F%E6%B4%9E%E7%89%88%E6%9C%AC%3A)

[1.3、描述：](#1.3%E3%80%81%E6%8F%8F%E8%BF%B0%EF%BC%9A)

[二、漏洞验证](#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81)

[2.1、分析：](#2.1%E3%80%81%E5%88%86%E6%9E%90%EF%BC%9A)

[2.2、解题：](#2.4%E3%80%81%E8%A7%A3%E9%A2%98%EF%BC%9A)

---


## 一、靶场环境

> 
<h3>1.1、平台：</h3>
[Vulfocus 漏洞威胁分析平台](https://vulfocus.cn/)
123.58.224.8:59532


登陆进去是一个文件上传页面




> 
<h3>1.2、知识:</h3>
httpd.conf是apache的一个配置文件，有很多对apache解析网页参数的设置
如：
1、AddType：为特定后缀的文件指定MIME类型（AddType text/html .html）
2、AddLanguage：语言的版本，如file1.html文档可以具备file1.html.en、file1.html.cn等不同版本，后缀可以使用AddLanguage进行定义（AddLanguage zh-CN .cn）
3、AddHandler：指定非静态的处理类型，用指定的方式处理非静态文档后，再向浏览器返回处理结果（AddHandler application/x-httpd-php .php）造成解析漏洞
……


> 
<h3>1.3、描述：</h3>
Apache HTTPD 支持一个文件拥有多个后缀，并为不同后缀执行不同的指令
在有多个后缀的情况下，只要一个文件含有.php后缀的文件即将被识别成PHP文件，没必要是最后一个后缀。利用这个特性，将会造成一个可以绕过上传白名单的解析漏洞


---


---


## 二、漏洞验证

> 
<h3>2.1、分析：</h3>
上传个明马


点击提交，并抓包


发送到repeater
webshell.php改为webshell.php.jpg
得到了路径/var/www/html/uploadfiles/webshell.php.jpg


 别在ip后加上这个完整的地址<img alt="" height="255" src="https://img-blog.csdnimg.cn/38376ed132da4a02a71386d92fdea184.png" width="861"/>


/uploadfiles/webshell.php.jpg

<hr/>

使用蚁剑连接




> 
<h3>2.2、解题：</h3>
 题目提示在/tmp目录下



