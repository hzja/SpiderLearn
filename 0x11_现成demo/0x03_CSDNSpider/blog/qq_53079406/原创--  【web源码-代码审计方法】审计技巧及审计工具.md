# 原创
：  【web源码-代码审计方法】审计技巧及审计工具

# 【web源码-代码审计方法】审计技巧及审计工具

**目录**

[一、审计情况：](#%E4%B8%80%E3%80%81%E5%AE%A1%E8%AE%A1%E6%83%85%E5%86%B5%EF%BC%9A)

[1.1、有源码:](#1.1%E3%80%81%E6%9C%89%E6%BA%90%E7%A0%81%3A)

[1.2、有二进制程序:](#1.2%E3%80%81%E6%9C%89%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%A8%8B%E5%BA%8F%3A)

[1.3、有源码、二进制程序:](#1.3%E3%80%81%E6%9C%89%E6%BA%90%E7%A0%81%E3%80%81%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%A8%8B%E5%BA%8F%3A)

[1.4、完全黑盒:](#1.4%E3%80%81%E5%AE%8C%E5%85%A8%E9%BB%91%E7%9B%92%3A)

[二、影响：](#%E4%BA%8C%E3%80%81%E5%BD%B1%E5%93%8D%EF%BC%9A)

[2.1、代码语言:](#2.1%E3%80%81%E4%BB%A3%E7%A0%81%E8%AF%AD%E8%A8%80%3A)

[2.2、代码风格:](#2.2%E3%80%81%E4%BB%A3%E7%A0%81%E9%A3%8E%E6%A0%BC%3A)

[三、审计思路](#%E4%B8%89%E3%80%81%E5%AE%A1%E8%AE%A1%E6%80%9D%E8%B7%AF)

[3.1、敏感关键字回溯参数传递](#3.1%E3%80%81%E6%95%8F%E6%84%9F%E5%85%B3%E9%94%AE%E5%AD%97%E5%9B%9E%E6%BA%AF%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92)

[3.2、接口分析](#3.2%E3%80%81%E6%8E%A5%E5%8F%A3%E5%88%86%E6%9E%90)

[3.3、敏感功能点建模](#3.3%E3%80%81%E6%95%8F%E6%84%9F%E5%8A%9F%E8%83%BD%E7%82%B9%E5%BB%BA%E6%A8%A1)

[3.4、全文关键代码](#3.4%E3%80%81%E5%85%A8%E6%96%87%E5%85%B3%E9%94%AE%E4%BB%A3%E7%A0%81)

[3.5、还原安全边界](#3.5%E3%80%81%E8%BF%98%E5%8E%9F%E5%AE%89%E5%85%A8%E8%BE%B9%E7%95%8C)

[四、小型源码](#%E5%9B%9B%E3%80%81%E5%B0%8F%E5%9E%8B%E6%BA%90%E7%A0%81)

[4.1、审计步骤：](#4.1%E3%80%81%E5%AE%A1%E8%AE%A1%E6%AD%A5%E9%AA%A4%EF%BC%9A)

[五、大型源码](#%E4%BA%94%E3%80%81%E5%A4%A7%E5%9E%8B%E6%BA%90%E7%A0%81)

[5.1、审计步骤：](#5.1%E3%80%81%E5%AE%A1%E8%AE%A1%E6%AD%A5%E9%AA%A4%EF%BC%9A)

[六、审计工具](#%E5%85%AD%E3%80%81%E5%AE%A1%E8%AE%A1%E5%B7%A5%E5%85%B7)

[6.1、Seay源代码审计系统](#6.1%E3%80%81Seay%E6%BA%90%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%B3%BB%E7%BB%9F)

[6.2、RIPS](#6.2%E3%80%81RIPS)

---


## 一、审计情况：

> 
<h3>1.1、有源码: </h3>
通常不包含完整的编译和测试环境，且缺乏必须的关键依赖组件，往往无法构建出可运行的程序
一般只能使用静态分析的方式去进行审计
<hr/>
<h3>1.2、有二进制程序: </h3>
如 APK、EXE、jar 包、IoT 的系统固件等
通常通过动态分析以及逆向工程的方式进行审计
<hr/>
<h3>1.3、有源码、二进制程序: </h3>
审计提供了最为有利的访问权限，通常目标是开源软件，包含了完整的构建环境和依赖
<hr/>
<h3>1.4、完全黑盒: </h3>
只能通过外部接口去进行盲测（较为常见）


### 1.2、有二进制程序: 

---


### 1.4、完全黑盒: 

 

---


---


## 二、影响：

> 
<h3>2.1、代码语言: </h3>
C/C++ 这种内存不安全的语言需要更多关注底层细节
Java、Python 等内存安全的语言则更多关注上层逻辑实现；
<hr/>
<h3>2.2、代码风格: </h3>
整洁、注释清晰的项目通常比其他项目花费更少时间去审计


### 2.2、代码风格: 

---


---


## 三、审计思路

> 
<h3>3.1、敏感关键字回溯参数传递</h3>
大多数漏洞是由于函数的使用不当造成的
搜索相应敏感关键字，即可快速挖掘想要的漏洞，可定向挖掘，高效、高质量
但是由于没有通读代码，对程序整体架构了解不够深入，在挖掘漏洞时定位利用会花点时间，且对逻辑漏洞挖掘覆盖不到


> 
<h3>3.2、接口分析</h3>
查找可控变量及其函数，正向追踪变量传递过程
数据入口点，如函数的参数、环境变量等，寻找可被恶意输入触发的安全漏洞


> 
<h3>3.3、敏感功能点建模</h3>
按功能点分块寻找
文件上传功能、支付功能……
通过行为建模还原模块的抽象行为，并寻找潜在的逻辑和功能漏洞


> 
<h3>3.4、全文关键代码</h3>
函数集文件：即公共函数文件，通过打开index.php或者一些功能性文件进行寻找
配置文件：一般包含config关键字，会有配置选项、数据库等配置信息
安全过滤文件：一般包含filter、safe、check等关键字
index文件：程序的入口，了解整个程序的架构、运行的流程、包含到的文件


> 
<h3>3.5、还原安全边界</h3>
通过分析所有安全相关的校验和检查代码
还原开发者或者安全架构师预设的安全边界，从而对还原后安全边界进行进一步审计，构建实际攻击的威胁模型


---


---


## 四、小型源码

> 
代码量一般都不大，相对比较容易找到漏洞
<h3>4.1、审计步骤：</h3>
(1）输入点：找到各个输入点。
(2）防护措施：找到针对输入的过滤并尝试绕过。
(3）函数漏洞：找到处理输入的函数并查看有无漏洞。
(4）利用：找到漏洞后进行最充分的利用。


---


---


## 五、大型源码

> 
一般都是对CMS型的框架进行审计，主要问题是需要从大量代码中快速定位到漏洞
<h3>5.1、审计步骤：</h3>
（1）寻找危险函数
（2）向上回溯，寻找可用输入点
（3）绕过针对输入点的过滤
（4）构造触发漏洞


---


---


## 六、审计工具

> 
<h3>6.1、Seay源代码审计系统</h3>
下载：
链接：https://pan.baidu.com/s/1H51ez9BrYohDP4hXHJLReA?pwd=bgz1 <br/> 提取码：bgz1

<hr/>
<h3>6.2、RIPS</h3>
链接：https://pan.baidu.com/s/14RWI64sU8LU-z9qUeVUzBg?pwd=yot6 <br/> 提取码：yot6



### 6.2、RIPS
