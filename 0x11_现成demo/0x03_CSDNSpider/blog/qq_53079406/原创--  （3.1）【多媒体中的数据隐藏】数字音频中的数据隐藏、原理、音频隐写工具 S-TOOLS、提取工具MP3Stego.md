# 原创
：  （3.1）【多媒体中的数据隐藏】数字音频中的数据隐藏、原理、音频隐写工具 S-TOOLS、提取工具MP3Stego

# （3.1）【多媒体中的数据隐藏】数字音频中的数据隐藏、原理、音频隐写工具 S-TOOLS、提取工具MP3Stego

**目录**

[一、多媒体简介](#%E4%B8%80%E3%80%81%E5%A4%9A%E5%AA%92%E4%BD%93%E7%AE%80%E4%BB%8B)

[1.1、流行：](#1.1%E3%80%81%E6%B5%81%E8%A1%8C%EF%BC%9A)

[1.2、隐患：](#1.2%E3%80%81%E9%9A%90%E6%82%A3%EF%BC%9A)

[二、 数字音频中的数据隐藏](#%E4%BA%8C%E3%80%81%20%E6%95%B0%E5%AD%97%E9%9F%B3%E9%A2%91%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E9%9A%90%E8%97%8F)

[2.1、简介：](#2.1%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[2.2、原理：](#2.2%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[三、简单音频文件嵌入技术（不可感知的方法）](#%E4%B8%89%E3%80%81%E7%AE%80%E5%8D%95%E9%9F%B3%E9%A2%91%E6%96%87%E4%BB%B6%E5%B5%8C%E5%85%A5%E6%8A%80%E6%9C%AF%EF%BC%88%E4%B8%8D%E5%8F%AF%E6%84%9F%E7%9F%A5%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%89)

[3.1、历史：](#3.1%E3%80%81%E5%8E%86%E5%8F%B2%EF%BC%9A)

[3.2、原理：](#3.2%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[3.3、 示例](#3.3%E3%80%81%C2%A0%E7%A4%BA%E4%BE%8B)

[四、在．wav文件中隐蔽数据](#%E5%9B%9B%E3%80%81%E5%9C%A8%EF%BC%8Ewav%E6%96%87%E4%BB%B6%E4%B8%AD%E9%9A%90%E8%94%BD%E6%95%B0%E6%8D%AE)

[4.1、原理：](#4.1%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[4.2、结论：](#4.2%E3%80%81%E7%BB%93%E8%AE%BA%EF%BC%9A)

[4.3、 音频隐写工具 S-TOOLS](#4.3%E3%80%81%20%E9%9F%B3%E9%A2%91%E9%9A%90%E5%86%99%E5%B7%A5%E5%85%B7%20S-TOOLS)

[4.3.1、简介：](#4.3.1%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[ 4.3.2、下载、使用方法：](#%C2%A04.3.2%E3%80%81%E4%B8%8B%E8%BD%BD%E3%80%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A)

[五、LSB波形数据隐藏的隐写分析](#%E4%BA%94%E3%80%81LSB%E6%B3%A2%E5%BD%A2%E6%95%B0%E6%8D%AE%E9%9A%90%E8%97%8F%E7%9A%84%E9%9A%90%E5%86%99%E5%88%86%E6%9E%90)

[5.1、介绍：](#5.1%E3%80%81%E4%BB%8B%E7%BB%8D%EF%BC%9A)

[5.2、原理：](#5.2%E3%80%81%E5%8E%9F%E7%90%86%EF%BC%9A)

[5.3、防护：](#5.3%E3%80%81%E9%98%B2%E6%8A%A4%EF%BC%9A)

[六、高级的音频文件数据隐藏](#%E5%85%AD%E3%80%81%E9%AB%98%E7%BA%A7%E7%9A%84%E9%9F%B3%E9%A2%91%E6%96%87%E4%BB%B6%E6%95%B0%E6%8D%AE%E9%9A%90%E8%97%8F)

[6.1、简介：](#6.1%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[6.2、MP3Stego工具：](#6.2%E3%80%81MP3Stego%E5%B7%A5%E5%85%B7%EF%BC%9A)

---


 

---


## 一、多媒体简介

> 
<h3>1.1、流行：</h3>
数字音乐、 播客、 现场录制的网络研讨会、 视频电话和媒体流等各种多媒体几乎普遍存在千各个组织中， 它们已经改变了我们的沟通方式。
<hr/>
将介绍早期在数字多媒体文件中数据隐藏的一些简单方法， 然后介绍一些前沿技术，而这些技术都对多媒体数据隐藏提出了独到的见解。


> 
<h3>1.2、隐患：</h3>
（1）数字多媒体这些通道会不会用来传输隐蔽消息、 泄漏知识产权和组织内部机密呢？
<hr/>
（2）会不会用来传递命令和控制信息， 或者为更高级的永久性威胁提供一些必要的技术准备呢？
<hr/>
（3）多媒体文件的大小通常比单张数字照片大很多， 这是不是意味着通过挖掘利用多媒体载体的脆弱性可以交换或泄露更多的隐藏信息呢？
<hr/>
（4）能否发现因以此种形式嵌入隐藏信息而导致的异常现象呢？


---


---


## 二、 数字音频中的数据隐藏

> 
<h3>2.1、简介：</h3>
 由于人类的听觉很敏锐， 所以人类听觉系统增加了嵌入数据的难度。 研究表明人类听觉系统有一个很大的频谱范围， 它的差分范围相当小。
不是不去获取音频中的隐藏信息，而是根本不知道里面有隐藏信息。


> 
<h3>2.2、原理：</h3>
高音量的声音会掩盖低音量的声音。人类听觉系统只能感知相对相位，而无法感知绝对相位。
<hr/>
这些局限性成了某些数据隐藏技术研究最基本的突破点。人们可以利用这些局限性来欺骗人耳，从而达到隐藏数据的目的。
<hr/>
音频文件作为数据隐藏的载体的其他优势：载体文件越来越大， 在其中隐藏非常多的载荷。
<hr/>
早期， 一些在多媒体音频文件中隐藏数据的技术专注于让嵌入数据无法感知而不是无法检测。 当播放文件时， 这些技术可以很成功地欺骗我们的听觉。
如果去检测被嵌入数据的音频文件， 就很容易发现隐藏的数据。


---


---


## 三、简单音频文件嵌入技术（不可感知的方法）

> 
<h3>3.1、历史：</h3>
早期的多媒体数据隐藏方法是针对原始音频文件的， 如wav文件。
最常用的音频数字化方法的理论依据，认为音频文件数字化根本没必要抓取整个模拟波形， 只需要对模拟信号进行取样并保存一些样本， 然后用这些 样本来重建原始的音频信号。


认为要想得到原始模拟信号的高质量数字副本，采样频率必须是原始模拟波形带宽的两倍， 这些发现奠定了脉冲编码调制 (Pulse Code Modulation, PCM) 标准的基础。



> 
<h3>3.2、原理：</h3>
典型的频率为 4KHz 的声音信号需要每秒采样 80000 次才能重建出高质址的数字信号， 要想重建覆盖整个人类听觉频谱 (22.SKHz) 的高质量录音文件， 则需要每秒采样 44 100 次。 由于音乐通常都是立体声（双声道）的， 每个声道都要进行每秒 44 100 次的采样， 也就是说一个立体声音乐每秒要进行 88 200 次数字采样。 采样后， 使用这些样本就可以近似地还原原始模拟信号， 实现数字到模拟的转换了。
这些样本值极有可能被用来隐藏数据。  每秒内采集的 88 200 个样本值都是以有符号 16 位整数形式存在的， 即－32 768 ~ +32 767。 因此， 改变这些样本值的最低有效位 (LSB) 只会略微影响模拟信号的效果 ， 多媒体音频文件的这个特性说明它是个可以用来隐藏数据的良好载体。
再生的 ．wav 文件有具体且明确的格式， 这个格式相当灵活。 现在我们仍在使用这种格式进行数字录制和传输。 我们使用的大多数 ．wav 文件格式都进行了少量的简化处理， 只包括格式段和数据段。


> 
<h3>3.3、 示例</h3>
一个真实的录音， 定义了每个字段的长度， 又对每个字段进行了简要介绍， 并注明了每个值的字节存储顺序， 这样就可以解释这段录音了。

波形文件 (wav) 文件头示例
文件头中的关键值包括：
音频类型：WAVE。
调制方法：本例中以PCM为例。
声道个数：2, 大多数音频文件都有两个声道。
采样频率：每个声道 44 100（根据奈奎斯特定理(Nyquist'stheorem)）。
每次采样使用的字节数和位数。
文件头下方是连续的数据信息， 而数据长度是是规定好的，大小为4 字节的十六进制数 04-5C-67-00。 下面我们推导每个声道的采样值：首先， 通过交换04-5C-67-00 的字节和字将小端序转换成大端序， 得到数据的实际长度为00-67-5C-04（十六进制）或者6 737 476 （十进制）。 因为本例中的音频文件有两个声道， 所以我们再把这个 结果除以2, 也就是每个 声道3386 882个 字节。 每个记录的样本大小为16位(2 字节）， 因此， 每个声道的采样值为1 693 441。 此外， 由于本例中的音频时长约为38秒， 我们也可以通过38s X 44 100样例／s得到每声道的采样值

波形样本数据示例



接下来， 我们分析下单个数据值。 把前面几个样本按左右声道分开， 将小端序转换成大端序。 然后， 取每个数值(16位一组） 的二补数（补码）， 将最高有效位作为符号位 。如果最高有效位为1, 则该值为负数。 这样 我们就完成了这个样本的解码：右声道前4个数值依次为－1,、－42、 -93和 －124。 使用StegoAnalyst来呈现波形， 我们就可以看到这个 38秒的音频文件的完整波形了。<br/>  
.wav音频文件的所有样本波形，左声道在上， 右声道在下


我们只看StegoAnglyst呈现的波形的前4个数值， 可以看到， 与之前通过从原始数据中提取并转换得到的结果是完全一致的。
wav音频文件的前4个样本，左声道在上， 右声道在下




---


## 四、在．wav文件中隐蔽数据

> 
<h3>4.1、原理：</h3>
对wav文件的构造有了深入理解， 也了解了奈奎斯特定理的基本原理以及它是如何促成脉冲编码调制 (Pluse Code Modulation, PCM) 产生的，还知道文件中存储的采样值可以转化为 16 位的有符号整数。

在．wav文件中嵌入隐藏信息了。 也许你已经猜到了，方法就是修改 16 位整数的最低有效位以编码隐藏信息。 我们提取了上节示例中．wav 文件的右声道的前 8 个样本， 然后将样本值由小端序转换为大端序， 再将每个值的最低有效位依次替换为字母 “ A" 的 ASCII 码的二进制位。


> 
<h3>4.2、结论：</h3>
（1） 每替换 个 8 位的ASCII 码需要使用 8 个样本。
（2） 实际上， 本例中的8 个样本值只改变了 5 个， 因为其他 3 个最低有效位不需要修改， 因此这种替换并没有引起可察觉的改变。 而传统的最低有效位替换方法都会插入一些随机数据（大多数数据隐藏或隐写程序在嵌入数据前都会进行压缩和加密处理，因此会产生伪随机性）， 替换率大概为 50%。 如果要隐藏 8000 字节的信息只需要修改大约 32 000 个样本， 而不是 64 000 个。



> 
<h3>4.3、 音频隐写工具 S-TOOLS</h3>

<blockquote>
<h4>4.3.1、简介：</h4>
S-TOOLS还会用基千密码的密钥对文件进行加密， 并支持多种加密算法
<hr/>
S-TOOLS还能够并排显示处理前后的两个波形， 粗略地检查下数据隐藏操作是否导致了大幅度的波形改变。


> 
<h4> 4.3.2、下载、使用方法：</h4>
[【音频隐写】S-TOOLS具体使用步骤（准备+载体+分析+hidden+加密+对比）、附下载链接<img alt="icon-default.png?t=M3K6" src="https://csdnimg.cn/release/blog_editor_html/release2.1.0/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M3K6"/>https://blog.csdn.net/qq_53079406/article/details/124677358](https://blog.csdn.net/qq_53079406/article/details/124677358)


---


## 五、LSB波形数据隐藏的隐写分析

> 
<h3>5.1、介绍：</h3>
波形文件中通过LSB隐藏的数据是很难察觉的。即使是经过严格训练的人， 也不能听出嵌入数据前后的两个音频间的差异。
<hr/>
但如果同时拥有这两个文件并进行对比分析， 就会很容易发现两者的不同。 通过分析两个波形的差异， 可以推导出数据隐藏使用的是LSB方法。
<hr/>
然而， 大多数情况下可供检查的只有一个嵌入数据后的文件。 就需要在没有原文件可供对比的情况下检测该文件是否进行过LSB修改。


---


> 
<h3>5.2、原理：</h3>
原波形文件样本的最低有效位值包含信息而非随机的噪音。检测LSB波形文件数据隐藏的关键是检查波形文件的最低有效位值组成的是有意义的信息还是简单的随机噪音
<hr/>
eg：如果提取每个样本的最低有效位值， 我们得到的可能是这个音乐的一些残缺片段
<hr/>
一个常用的方法就是估计位流的压缩率。 对千波形音频文件， 可以提取每个声道的最低有效位， 然后进行统计分析实验(1990年， Mauer做过此类实验）。Mauer的实验最初是为了评估随机数生成器（用千加密应用程序）的质量并提供 “随机性质量＂ 。我们可以利用这种方法来分析波形音频文件的LSB中包含信息的随机性。


---


> 
<h3>5.3、防护：</h3>
对抗LSB音频数据隐藏的一个方法就是采取主动监管， 就是将指定数量样本的最低有效位值清零。 这样播放音频的时候无法察觉， 同时也破坏了密信的传输渠道， 接收者就无法获取真正的信息了。


---


## 六、高级的音频文件数据隐藏

> 
<h3>6.1、简介：</h3>
十年前， 音频文件的数据嵌入技术发展缓慢， 即使是现在， 也只有少数几个数据隐藏或隐写工具支待常见的压缩音频文件（如MP3或AAC)数据嵌入。 最著名的就是MP3Stego, 它采用一种特殊的量化方法， 并将数据隐藏在MP3文件的奇偶校验块中。MP3编码器将wav文件和一个要隐藏的载荷文件作为输入， 生成一个新的mp3文件。 这种方法最显著的局限性在于载荷文件不能太大。 例如， 一个6MB的全频谱波形音频文件最多只能嵌入6KB的信息， 嵌入率约为0.1%


> 
<h3>6.2、MP3Stego工具：</h3>
[【音频隐写提取】MP3Stego下载、命令、使用方法<img alt="icon-default.png?t=M3K6" src="https://csdnimg.cn/release/blog_editor_html/release2.1.0/ckeditor/plugins/CsdnLink/icons/icon-default.png?t=M3K6"/>https://blog.csdn.net/qq_53079406/article/details/124680295?spm=1001.2014.3001.5501](https://blog.csdn.net/qq_53079406/article/details/124680295?spm=1001.2014.3001.5501)


