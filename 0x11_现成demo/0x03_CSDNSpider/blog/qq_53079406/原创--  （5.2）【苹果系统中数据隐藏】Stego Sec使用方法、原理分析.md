# 原创
：  （5.2）【苹果系统中数据隐藏】Stego Sec使用方法、原理分析

# （5.2）【苹果系统中数据隐藏】Stego Sec使用方法、原理分析

**目录**

[一、简介：](#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[二、使用方法：](#%E4%BA%8C%E3%80%81%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A)

[第一步：选择图像](#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E9%80%89%E6%8B%A9%E5%9B%BE%E5%83%8F)

[第二步：输入隐藏信息](#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%BE%93%E5%85%A5%E9%9A%90%E8%97%8F%E4%BF%A1%E6%81%AF)

[第三步：处理图像](#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%A4%84%E7%90%86%E5%9B%BE%E5%83%8F)

[三、数据隐藏方法分析](#%E4%B8%89%E3%80%81%E6%95%B0%E6%8D%AE%E9%9A%90%E8%97%8F%E6%96%B9%E6%B3%95%E5%88%86%E6%9E%90)

[隐藏信息的内容：](#%E9%9A%90%E8%97%8F%E4%BF%A1%E6%81%AF%E7%9A%84%E5%86%85%E5%AE%B9%EF%BC%9A)

[ 分析：](#%C2%A0%E5%88%86%E6%9E%90%EF%BC%9A)

[ 推测：](#%C2%A0%E6%8E%A8%E6%B5%8B%EF%BC%9A)

[总结：](#%E6%80%BB%E7%BB%93%EF%BC%9A)

---


> 
<h2>一、简介：</h2>
可以在照片（直接拍摄、存储在 iPhone/iPad）中嵌入文本。
对象：JPEG图像


> 
<h2>二、使用方法：</h2>
导航面板（6.14），加密图像处理过程（数据隐藏过程）
<hr/>
<h3>第一步：选择图像</h3>
支持从相册中选择已有的照片或直接拍摄照片。在相册中选择标准的雪鸦图像作为示例照片（ 6.15 ）


<hr/>
<h3>第二步：输入隐藏信息</h3>
用户输入待隐藏的文本消息，我们输入"This is a test of emergency broadcast system, this is only a test。" （6.16）<br/> 在嵌入隐藏消息前会对文本消息加密，所以还需要输入密码。 在输人密码的同一个界面上， 还需要输入一个文件名作为嵌入数据后新图像的名称（6.17）


<hr/>


<h3>第三步：处理图像</h3>
点击 Go"确认输入信息， 完成数据隐藏（6.18 ）<br/> 再浏览隐藏消息（6.19）， 也可以通过email或短信将处理过的图像发送给目标（6.20 ）






---


### 第二步：输入隐藏信息

---


---


## 三、数据隐藏方法分析

> 
<h3>隐藏信息的内容：</h3>
（1）原始JPEG载体图像
（2）巳嵌入数据的JPEG图像
（3）秘密信息内容，且其长度为70个字符
（4）用千加密秘密信息的密码


> 
<h3> 分析：</h3>
利用上述内容， 审查数据嵌入前后的图像， 来分析其使用的数据隐藏方法。
<hr/>
用Stego Analyst工具来帮助我们检查嵌人数据后的图像， 进而分析使用的是哪种数据隐藏方法。  左边的是原始雪鸦图像， 右边是用StegoSec嵌入紧急通知消息的图像（6.21）


对StegoSec嵌入的短消息文件进行了标记， 后续需要对比不同长度的消息来确认具体的数据嵌入方法。  
发现文件大小在数据嵌入前后有非常显著的差异（6.22）：



原始载体文件：I09 562字节。待隐藏的短消息：11525字节。


> 
<h3> 推测：</h3>
数据隐藏方法很可能涉及对JPEG图像重新编码，进而可以推断出JPEG中的量化DCT（离散余弦变换）值被修改了，否则也没有必要对图像进行重新编码。我们还验证过图像中没有任何游离的批注区域，文件头或文件尾部没有多一个实验了，验证下余的数据，文件结构上也没有任何异常改变。
<hr/>
进行下之前的推测，看数据隐藏时是否真地改变了量化DCT值。用StegoSec嵌入了另一条文本消息，这条消息长度是350字节（上次在短消息中嵌入的消息长度是70字节），为了只改变一个向量（消息长度），加密时还使用上次同样的密码。

将这两次处理过的图像进行对比（6.23）




在图像中嵌入不同长度的消息后， 图像大小方面的差异很小。 但是嵌入的原始文本消息大小差异为350 - 70 = 280字节。
<hr/>
验证推测：消息并不是简单地插入到JPEG的非图像数据区域。 为了仔细检查嵌入不同长度消息的两张图像之间的差异， 我们将直接分析每张图像的量化DCT值，并进行对比。
<hr/>
（6.23）两张图像的量化DCT的DC系数的直方图基本类似， 这个直方图显示了从量化表中提取的每个DC值在图像中存在的个数。 （6.24）描述了带有DC系数值的量化DCT。


<img alt="" height="341" src="https://img-blog.csdnimg.cn/70e9f3d02ac245bd8c747e50af333701.png" width="784"/><br/> 为了检查最化值间的具体差异，还需要进一步分析一组直方图中的单个值，来揭露DC 系数直方图中DC值的微小差异。
<hr/>
（6.25）高亮的数值表示因嵌入长度不同的两条消息导致的DC值的微小差异。因为本例中我们用了相同的原始载体图像，加密时也使用了相同的密码，唯一不同的是嵌入消息的长度
可以得出结论：该数据隐藏方法修改了量化DCT的DC系数。所以，StegoSec的数据隐藏方法会直接修改JPEG的损耗值。
 <img alt="" height="602" src="https://img-blog.csdnimg.cn/5b23e73c9505432b8b87f7185067de77.png" width="927"/>



---


---


> 
<h3>总结：</h3>
由于嵌入的消息体积相对较小（仅几百字节），仅通过统计方法检测而没有人工参与分析的话， 很难发现其中的异常。所以，在只需嵌入少量数据时，Stego Sec是一个可行的数据隐藏工具。
<hr/>
上个版本的StegoSec是将隐藏数据嵌入到JPEG的文件头区域，很容易就能检测并恢复隐藏消息。上个版本的StegoSec嵌入数据后图像的十六进制编码数据（6.26）， 其中被隐藏的文本消息就位于EXIF JPEG文件头部。



